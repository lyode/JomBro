<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="JomBro">
    <meta name="theme-color" content="#ff6b9d">
    <meta name="description" content="AI-Powered Social Challenge Platform - Connect, Challenge, Conquer!">
       
    <title>JomBro - Challenge Platform</title>

    <style>
        :root {
            --safe-area-top: env(safe-area-inset-top, 20px);
            --safe-area-bottom: env(safe-area-inset-bottom, 20px);
            --primary-pink: #ff6b9d;
            --primary-purple: #8b5cf6;
            --primary-blue: #00d4ff;
            --accent-pink: #ff8cc8;
            --dark-bg: #0a0a0a;
            --glass-bg: rgba(15, 15, 15, 0.45);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --success-green: #10b981;
            --warning-orange: #f59e0b;
            --error-red: #ef4444;
            
            /* Animation Variables */
            --animation-speed-fast: 0.2s;
            --animation-speed-normal: 0.3s;
            --animation-speed-slow: 0.5s;
            --easing-smooth: cubic-bezier(0.4, 0, 0.2, 1);
            --easing-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            touch-action: manipulation;
        }

        html, body {
            height: 100vh;
            width: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
            background: #000000;
            color: var(--text-primary);
            user-select: none;
            overflow: hidden;
            perspective: 2000px;
            perspective-origin: center center;
        }

        /* Animations */
        @keyframes float-in {
            from {
                opacity: 0;
                transform: translate3d(0, 20px, 0) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translate3d(0, 0, 0) scale(1);
            }
        }
        
        @keyframes slide-up {
            from {
                opacity: 0;
                transform: translate3d(0, 100%, 0);
            }
            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }
        
        @keyframes scale-in {
            from {
                opacity: 0;
                transform: scale3d(0.8, 0.8, 1);
            }
            to {
                opacity: 1;
                transform: scale3d(1, 1, 1);
            }
        }
        
        @keyframes pulse-glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(255, 107, 157, 0.3);
                transform: scale3d(1, 1, 1);
            }
            50% { 
                box-shadow: 0 0 30px rgba(255, 107, 157, 0.6);
                transform: scale3d(1.02, 1.02, 1);
            }
        }

        @keyframes online-pulse {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
            }
            50% { 
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }
        }

        @keyframes ai-generate {
            0%, 100% { 
                background: transparent;
                border-color: rgba(255, 107, 157, 0.3);
            }
            50% { 
                background: transparent;
                border-color: rgba(139, 92, 246, 0.3);
            }
        }

        /* Space Background */
        .background-layer {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1;
            overflow: hidden;
        }

        .space-background {
            background: 
                linear-gradient(180deg, 
                    #000011 0%, 
                    #001122 15%, 
                    #002244 25%, 
                    #001a3a 35%,
                    #002850 45%, 
                    #001133 55%, 
                    #001428 65%,
                    #000822 75%, 
                    #000511 85%,
                    #000208 100%
                );
            position: relative;
            overflow: hidden;
            height: 100%;
        }

        .stars {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(3px 3px at 25px 30px, #ffffff, transparent),
                radial-gradient(2px 2px at 85px 20px, rgba(255,255,255,0.9), transparent),
                radial-gradient(3px 3px at 145px 40px, #ffffff, transparent),
                radial-gradient(2px 2px at 205px 65px, rgba(255,255,255,0.8), transparent),
                radial-gradient(3px 3px at 265px 25px, #ffffff, transparent),
                radial-gradient(2px 2px at 325px 55px, rgba(255,255,255,0.9), transparent),
                radial-gradient(1.5px 1.5px at 55px 50px, rgba(255,255,255,0.7), transparent),
                radial-gradient(1px 1px at 115px 75px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1.5px 1.5px at 175px 15px, rgba(255,255,255,0.8), transparent);
            background-repeat: repeat;
            background-size: 400px 120px;
            animation: starTwinkle 4s ease-in-out infinite;
        }

        @keyframes starTwinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .shooting-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: linear-gradient(45deg, #ffffff, #00bfff);
            border-radius: 50%;
            box-shadow: 0 0 6px 2px rgba(255, 255, 255, 0.8);
            animation: meteorShower 8s linear infinite;
        }

        @keyframes meteorShower {
            0% {
                transform: translate3d(-100px, -100px, 0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translate3d(-50px, -50px, 0) scale(1);
            }
            90% {
                opacity: 1;
                transform: translate3d(calc(100vw + 50px), calc(100vh + 50px), 0) scale(1);
            }
            100% {
                transform: translate3d(calc(100vw + 100px), calc(100vh + 100px), 0) scale(0);
                opacity: 0;
            }
        }

        /* Glass UI Layer */
        .glass-layer {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* Top Right Feature Buttons - TRANSPARENT */
        .top-right-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 4500;
        }

        .top-feature-btn {
            background: transparent;
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .top-feature-btn:hover {
            background: transparent;
            border-color: var(--primary-pink);
            transform: translateY(-2px);
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.4);
        }

        .top-feature-btn.active {
            background: transparent;
            border-color: var(--primary-pink);
            color: var(--primary-pink);
        }

        /* Enhanced Right Side Overlay Buttons - IMPROVED TRANSPARENCY */
        .right-overlay-buttons {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 4000;
        }

        .overlay-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(30px) saturate(150%);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            font-size: 22px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .overlay-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%, 
                transparent 100%);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .overlay-button::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            opacity: 0;
            transition: all 0.6s ease;
        }

        .overlay-button:hover {
            transform: scale(1.15) translateY(-2px);
            box-shadow: 
                0 16px 48px rgba(0, 0, 0, 0.5),
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .overlay-button:hover::before {
            opacity: 1;
        }

        .overlay-button:hover::after {
            opacity: 1;
            transform: rotate(45deg) translate(50%, 50%);
        }

        .overlay-button:active {
            transform: scale(1.05) translateY(0);
        }

        .overlay-button.champions {
            border-color: rgba(255, 215, 0, 0.4);
            color: #ffd700;
            box-shadow: 
                0 8px 32px rgba(255, 215, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 215, 0, 0.2);
        }

        .overlay-button.champions:hover {
            border-color: rgba(255, 215, 0, 0.6);
            box-shadow: 
                0 16px 48px rgba(255, 215, 0, 0.3),
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 215, 0, 0.3);
        }

        .overlay-button.shames {
            border-color: rgba(255, 71, 87, 0.4);
            color: #ff4757;
            box-shadow: 
                0 8px 32px rgba(255, 71, 87, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 71, 87, 0.2);
        }

        .overlay-button.shames:hover {
            border-color: rgba(255, 71, 87, 0.6);
            box-shadow: 
                0 16px 48px rgba(255, 71, 87, 0.3),
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 71, 87, 0.3);
        }

        .overlay-button.chat {
            border-color: rgba(0, 212, 255, 0.4);
            color: #00d4ff;
            box-shadow: 
                0 8px 32px rgba(0, 212, 255, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(0, 212, 255, 0.2);
        }

        .overlay-button.chat:hover {
            border-color: rgba(0, 212, 255, 0.6);
            box-shadow: 
                0 16px 48px rgba(0, 212, 255, 0.3),
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(0, 212, 255, 0.3);
        }

        .overlay-button.online {
            border-color: rgba(16, 185, 129, 0.4);
            color: #10b981;
            box-shadow: 
                0 8px 32px rgba(16, 185, 129, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(16, 185, 129, 0.2);
        }

        .overlay-button.online:hover {
            border-color: rgba(16, 185, 129, 0.6);
            box-shadow: 
                0 16px 48px rgba(16, 185, 129, 0.3),
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(16, 185, 129, 0.3);
        }

        .overlay-button.groups {
            border-color: rgba(139, 92, 246, 0.4);
            color: #8b5cf6;
            box-shadow: 
                0 8px 32px rgba(139, 92, 246, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(139, 92, 246, 0.2);
        }

        .overlay-button.groups:hover {
            border-color: rgba(139, 92, 246, 0.6);
            box-shadow: 
                0 16px 48px rgba(139, 92, 246, 0.3),
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(139, 92, 246, 0.3);
        }

        .overlay-button.profile {
            border-color: rgba(255, 107, 157, 0.4);
            color: #ff6b9d;
            box-shadow: 
                0 8px 32px rgba(255, 107, 157, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 107, 157, 0.2);
        }

        .overlay-button.profile:hover {
            border-color: rgba(255, 107, 157, 0.6);
            box-shadow: 
                0 16px 48px rgba(255, 107, 157, 0.3),
                0 4px 16px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 107, 157, 0.3);
        }

        .overlay-button.ai-generating {
            animation: ai-pulse 2s infinite ease-in-out;
        }

        @keyframes ai-pulse {
            0%, 100% { 
                border-color: rgba(255, 107, 157, 0.4);
                box-shadow: 
                    0 8px 32px rgba(255, 107, 157, 0.2),
                    0 2px 8px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 107, 157, 0.2);
            }
            50% { 
                border-color: rgba(139, 92, 246, 0.6);
                box-shadow: 
                    0 12px 40px rgba(139, 92, 246, 0.3),
                    0 3px 12px rgba(0, 0, 0, 0.3),
                    inset 0 1px 0 rgba(139, 92, 246, 0.3);
            }
        }

        /* Enhanced Button Labels with Better Positioning */
        .overlay-button-label {
            position: absolute;
            right: 75px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            color: white;
            padding: 12px 18px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .overlay-button-label::before {
            content: '';
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid rgba(0, 0, 0, 0.9);
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
        }

        .overlay-button:hover .overlay-button-label {
            opacity: 1;
            visibility: visible;
            right: 70px;
        }

        /* Notification badges with enhanced styling */
        .button-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(135deg, #ff4757, #ff3838);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            animation: badgePulse 2s ease infinite;
            box-shadow: 
                0 4px 12px rgba(255, 71, 87, 0.4),
                0 0 0 2px rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes badgePulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 4px 12px rgba(255, 71, 87, 0.4),
                    0 0 0 2px rgba(255, 255, 255, 0.2);
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 
                    0 6px 16px rgba(255, 71, 87, 0.6),
                    0 0 0 4px rgba(255, 255, 255, 0.3);
            }
        }

        /* Enhanced Modal Styles - IMPROVED TRANSPARENCY */
        .feature-modal {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(40px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 35px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 5px 20px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .feature-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
        }

        .feature-icon {
            font-size: 36px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 107, 157, 0.3);
            color: var(--primary-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .feature-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .feature-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        .feature-content {
            margin-bottom: 25px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .feature-card {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .feature-card:hover {
            background: rgba(0, 0, 0, 0.3);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 16px 40px rgba(0, 0, 0, 0.4),
                0 4px 16px rgba(255, 107, 157, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 107, 157, 0.4);
        }

        .task-item {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: transparent;
            border-color: var(--primary-pink);
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--primary-pink);
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            background: transparent;
        }

        .task-checkbox.completed {
            background: var(--primary-pink);
            color: white;
        }

        .task-info {
            flex: 1;
        }

        .task-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .task-meta {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            gap: 15px;
        }

        .champions-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .champion-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: transparent;
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .champion-item:hover {
            background: transparent;
            transform: translateY(-2px);
            border-color: #ffd700;
        }

        .champion-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: transparent;
            border: 2px solid #ffd700;
            color: #ffd700;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
        }

        .champion-info {
            flex: 1;
        }

        .champion-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .champion-achievement {
            font-size: 12px;
            color: #ffd700;
            margin-top: 2px;
        }

        .champion-stats {
            text-align: right;
            font-size: 14px;
            font-weight: 700;
            color: #ffd700;
        }

        /* Chat Interface */
        .chat-container {
            height: 400px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .chat-message {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-message.own {
            background: transparent;
            border-color: rgba(255, 107, 157, 0.3);
            margin-left: 20px;
        }

        .chat-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: transparent;
            border: 2px solid var(--primary-pink);
            color: var(--primary-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        .chat-content {
            flex: 1;
        }

        .chat-username {
            font-size: 12px;
            color: var(--primary-pink);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .chat-text {
            font-size: 14px;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .chat-time {
            font-size: 10px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            background: transparent;
            color: var(--text-primary);
            font-size: 14px;
        }

        .chat-input input:focus {
            outline: none;
            border-color: var(--primary-pink);
        }

        .chat-send-btn {
            background: transparent;
            border: 2px solid var(--primary-pink);
            color: var(--primary-pink);
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .chat-send-btn:hover {
            background: rgba(255, 107, 157, 0.1);
            transform: scale(1.05);
        }

        /* Online Players Overlay - TRANSPARENT */
        .online-players-overlay {
            position: fixed;
            top: 80px;
            right: 20px;
            background: transparent;
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 15px;
            z-index: 5000;
            min-width: 200px;
            max-height: 400px;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .online-players-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .online-indicator {
            width: 8px;
            height: 8px;
            background: var(--success-green);
            border-radius: 50%;
            animation: online-pulse 2s infinite;
        }

        .online-player {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .online-player:last-child {
            border-bottom: none;
        }

        .player-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: transparent;
            border: 2px solid var(--primary-pink);
            color: var(--primary-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 600;
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .player-status {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* AI Challenge Notification */
        .ai-challenge-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: transparent;
            border: 2px solid var(--primary-pink);
            color: var(--primary-pink);
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            z-index: 6000;
            animation: float-in 0.5s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        /* Auth Screen - TRANSPARENT */
        .auth-screen {
            width: 100%;
            max-width: 420px;
            animation: float-in var(--animation-speed-slow) var(--easing-smooth);
        }

        .auth-container {
            background: transparent;
            backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 40px 35px;
            text-align: center;
            box-shadow: 
                0 8mm 16mm rgba(0, 0, 0, 0.3),
                0 2mm 8mm rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            animation: scale-in var(--animation-speed-normal) var(--easing-bounce);
        }

        .auth-logo {
            font-size: 48px;
            margin-bottom: 15px;
            animation: pulse-glow 3s ease-in-out infinite;
        }

        .auth-title {
            font-size: 28px;
            font-weight: 300;
            color: var(--text-primary);
            margin-bottom: 8px;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .auth-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 30px;
            line-height: 1.4;
        }

        /* Form Elements - TRANSPARENT */
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            padding-left: 5px;
        }

        .form-input {
            width: 100%;
            padding: 16px 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: transparent;
            backdrop-filter: blur(15px);
            color: var(--text-primary);
            font-size: 16px;
            transition: all var(--animation-speed-normal) var(--easing-smooth);
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-pink);
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.2);
            background: transparent;
            transform: scale3d(1.01, 1.01, 1);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .form-input:invalid {
            border-color: var(--error-red);
        }

        /* Password field specific */
        .password-container {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 18px;
            padding: 5px;
            border-radius: 4px;
            transition: color var(--animation-speed-fast);
        }

        .password-toggle:hover {
            color: var(--text-primary);
        }

        /* Buttons - TRANSPARENT */
        .btn-primary {
            background: transparent;
            backdrop-filter: blur(20px);
            color: var(--primary-pink);
            border: 2px solid var(--primary-pink);
            padding: 18px 24px;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all var(--animation-speed-normal) var(--easing-smooth);
            width: 100%;
            box-shadow: 
                0 6px 20px rgba(255, 107, 157, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            margin: 25px 0 15px 0;
            font-family: inherit;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left var(--animation-speed-normal) var(--easing-smooth);
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translate3d(0, -4px, 0) scale(1.02);
            box-shadow: 
                0 12px 40px rgba(255, 107, 157, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            background: rgba(255, 107, 157, 0.1);
        }

        .btn-primary:active {
            transform: translate3d(0, -2px, 0) scale(0.98);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: transparent;
            backdrop-filter: blur(15px);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--animation-speed-normal) var(--easing-smooth);
            font-family: inherit;
        }

        .btn-secondary:hover {
            background: transparent;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border-color: var(--primary-pink);
            color: var(--primary-pink);
        }

        .toggle-btn {
            background: none;
            border: none;
            color: var(--primary-pink);
            margin-top: 15px;
            cursor: pointer;
            width: 100%;
            font-size: 14px;
            text-decoration: underline;
            transition: color var(--animation-speed-normal);
            font-family: inherit;
            padding: 10px;
            border-radius: 8px;
        }

        .toggle-btn:hover {
            color: var(--accent-pink);
            background: transparent;
        }

        /* Loading State */
        .loading {
            position: relative;
            pointer-events: none;
            opacity: 0.7;
        }

        .loading .btn-text {
            opacity: 0;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 24px;
            height: 24px;
            margin: -12px 0 0 -12px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Messages */
        .message {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-weight: 600;
            font-size: 14px;
            animation: slide-up var(--animation-speed-normal) var(--easing-smooth);
            line-height: 1.4;
        }

        .message.error {
            background: transparent;
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }

        .message.success {
            background: transparent;
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #6ee7b7;
        }

        .message.info {
            background: transparent;
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #93c5fd;
        }

        .message.warning {
            background: transparent;
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fbbf24;
        }

        /* Connection Status */
        .connection-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
            padding: 10px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 12px;
        }

        .connection-status.connected {
            color: var(--success-green);
            border-color: var(--success-green);
        }

        .connection-status.disconnected {
            color: var(--error-red);
            border-color: var(--error-red);
        }

        .connection-status.connecting {
            color: var(--warning-orange);
            border-color: var(--warning-orange);
        }

        /* Main App Interface - TRANSPARENT */
        .glass-interface {
            width: 100%;
            max-width: 400px;
            height: calc(100vh - 20px);
            background: transparent;
            backdrop-filter: blur(25px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            box-shadow: 
                0 10mm 20mm rgba(0, 0, 0, 0.3),
                0 3mm 10mm rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                0 0 100px rgba(255, 107, 157, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            animation: slide-up var(--animation-speed-slow) var(--easing-smooth);
        }

        .glass-header {
            position: sticky;
            top: 0;
            z-index: 100;
            padding: calc(var(--safe-area-top) + 20px) 25px 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.12);
            background: transparent;
            backdrop-filter: blur(30px) saturate(180%);
        }

        .logo-slogan {
            font-size: 10px;
            color: var(--primary-pink);
            margin-top: -2px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.9;
        }

        .glass-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
            position: relative;
            z-index: 2;
            padding: 20px 25px;
        }

        .challenge-card {
            background: transparent;
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all var(--animation-speed-normal) var(--easing-smooth);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: float-in var(--animation-speed-normal) var(--easing-smooth);
        }

        .challenge-card:hover {
            background: transparent;
            transform: translate3d(0, -8px, 0) scale(1.02);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.4),
                0 0 40px rgba(255, 107, 157, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: var(--primary-pink);
        }

        .ai-challenge-card {
            border: 2px solid rgba(255, 107, 157, 0.5);
            background: transparent;
        }

        .ai-challenge-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 157, 0.2), transparent);
            animation: ai-generate 3s linear infinite;
        }

        /* Category Button Styles - TRANSPARENT */
        .category-btn {
            transition: all var(--animation-speed-normal) var(--easing-smooth);
            font-size: 14px;
            font-weight: 600;
            font-family: inherit;
            background: transparent !important;
        }

        .category-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .category-btn:active {
            transform: translateY(0) scale(0.95);
        }

        /* Achievement Badge - TRANSPARENT */
        .achievement-badge {
            background: transparent;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: all var(--animation-speed-normal) var(--easing-smooth);
        }

        .achievement-badge:hover {
            background: transparent;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        .achievement-badge.earned {
            border-color: var(--primary-pink);
            box-shadow: 0 0 15px rgba(255, 107, 157, 0.3);
        }

        /* Leaderboard Entry */
        .leaderboard-entry {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .leaderboard-entry:last-child {
            border-bottom: none;
        }

        .leaderboard-rank {
            font-size: 18px;
            font-weight: 700;
            width: 30px;
            text-align: center;
        }

        .leaderboard-rank.gold { color: var(--gold); }
        .leaderboard-rank.silver { color: var(--silver); }
        .leaderboard-rank.bronze { color: var(--bronze); }

        /* Settings Toggle */
        .settings-toggle {
            transition: all var(--animation-speed-normal) var(--easing-smooth);
            font-family: inherit;
            background: transparent;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: transparent;
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { transform: translateY(-50px) scale(0.9); }
            to { transform: translateY(0) scale(1); }
        }

        /* Enhanced Stats display boxes */
        .stats-box {
            background: rgba(0, 0, 0, 0.2) !important;
            backdrop-filter: blur(20px) saturate(150%);
            border: 1px solid rgba(255, 107, 157, 0.3);
            border-radius: 12px;
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .stats-box:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.4),
                0 2px 8px rgba(255, 107, 157, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 107, 157, 0.5);
        }

        /* Enhanced Quick action buttons */
        .quick-action-btn {
            background: rgba(0, 0, 0, 0.2) !important;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15) !important;
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .quick-action-btn:hover {
            background: rgba(0, 0, 0, 0.3) !important;
            transform: translateY(-2px);
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.3),
                0 2px 8px rgba(255, 107, 157, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 107, 157, 0.4) !important;
            color: var(--primary-pink) !important;
        }

        /* Enhanced Daily rewards grid */
        .daily-reward-item {
            background: rgba(0, 0, 0, 0.2) !important;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .daily-reward-item.claimed {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1) !important;
            box-shadow: 
                0 4px 12px rgba(16, 185, 129, 0.2),
                inset 0 1px 0 rgba(16, 185, 129, 0.2);
        }

        .daily-reward-item.today {
            border-color: #ff6b9d;
            background: rgba(255, 107, 157, 0.1) !important;
            box-shadow: 
                0 4px 12px rgba(255, 107, 157, 0.2),
                inset 0 1px 0 rgba(255, 107, 157, 0.2);
        }

        /* Enhanced Power-up items */
        .power-up-active {
            background: rgba(0, 0, 0, 0.2) !important;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .power-up-active:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.3),
                0 2px 8px rgba(255, 107, 157, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        /* Mobile responsive adjustments */
        @media (max-width: 480px) {
            .top-right-buttons {
                top: 10px;
                right: 10px;
                gap: 6px;
            }

            .top-feature-btn {
                padding: 8px 12px;
                font-size: 12px;
            }

            .top-feature-btn span:last-child {
                display: none;
            }

            .right-overlay-buttons {
                right: 10px;
                gap: 8px;
            }

            .overlay-button {
                width: 48px;
                height: 48px;
                font-size: 16px;
            }

            .overlay-button::after {
                right: 60px;
            }

            .overlay-button:hover::after {
                right: 55px;
            }

            .feature-modal {
                padding: 20px;
                max-width: 95%;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }

            .online-players-overlay {
                top: 60px;
                right: 10px;
                max-width: 180px;
            }

            .chat-container {
                height: 300px;
            }

            .champion-item {
                flex-direction: column;
                text-align: center;
            }

            .champion-stats {
                text-align: center;
                margin-top: 10px;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Background Layer -->
    <div class="background-layer">
        <div class="space-background">
            <div class="stars"></div>
            <div class="shooting-star" style="top: 15%; left: 5%; animation-delay: 0s;"></div>
            <div class="shooting-star" style="top: 35%; left: 20%; animation-delay: 2s;"></div>
            <div class="shooting-star" style="top: 60%; left: 30%; animation-delay: 4s;"></div>
            <div class="shooting-star" style="top: 25%; left: 50%; animation-delay: 6s;"></div>
        </div>
    </div>

    <!-- Top Right Feature Buttons -->
    <div id="topRightButtons" class="top-right-buttons hidden">
        <button class="top-feature-btn" onclick="showCreateChallenge()" data-feature="create">
            <span>➕</span>
            <span>Create Challenge</span>
        </button>
        <button class="top-feature-btn" onclick="showMyTasks()" data-feature="tasks">
            <span>📋</span>
            <span>My Tasks</span>
        </button>
        <button class="top-feature-btn" onclick="showSettings()" data-feature="settings">
            <span>⚙️</span>
            <span>Settings</span>
        </button>
    </div>

    <!-- Online Players Overlay -->
    <div id="onlinePlayersOverlay" class="online-players-overlay hidden">
        <div class="online-players-header">
            <div class="online-indicator"></div>
            <span style="font-size: 14px; font-weight: 600;">Online Players</span>
            <span id="onlineCount" style="font-size: 12px; color: var(--text-secondary);">0</span>
        </div>
        <div id="onlinePlayersList"></div>
    </div>

    <!-- Right Side Overlay Buttons -->
    <div id="rightOverlayButtons" class="right-overlay-buttons hidden">
        <button class="overlay-button champions" onclick="showChampions()">
            🏆
            <span class="button-badge" id="championsBadge">3</span>
            <div class="overlay-button-label">Champions</div>
        </button>
        <button class="overlay-button shames" onclick="showShames()">
            😅
            <span class="button-badge" id="shamesBadge">1</span>
            <div class="overlay-button-label">Hall of Shame</div>
        </button>
        <button class="overlay-button chat" onclick="showChat()">
            💬
            <span class="button-badge" id="chatBadge">7</span>
            <div class="overlay-button-label">Global Chat</div>
        </button>
        <button class="overlay-button online" onclick="toggleOnlinePlayers()">
            👥
            <div class="overlay-button-label">Online Players</div>
        </button>
        <button class="overlay-button groups" onclick="showGroups()">
            🏘️
            <span class="button-badge" id="groupsBadge">2</span>
            <div class="overlay-button-label">Groups</div>
        </button>
        <button class="overlay-button profile" onclick="showProfile()">
            👤
            <div class="overlay-button-label">My Profile</div>
        </button>
    </div>

    <!-- AI Challenge Notification -->
    <div id="aiChallengeNotification" class="ai-challenge-notification hidden">
        🤖 AI Generated new challenge!
    </div>

    <!-- Glass UI Layer -->
    <div class="glass-layer">
        <!-- Auth Screen -->
        <div id="authScreen" class="auth-screen">
            <div class="auth-container">
                <div class="auth-logo">🚀</div>
                <div class="auth-title">Welcome to JomBro</div>
                <div class="auth-subtitle">Join the ultimate challenge platform and push your limits!</div>
                
                <!-- Connection Status -->
                <div id="connectionStatus" class="connection-status connecting">
                    <span>🔄</span>
                    <span>Connecting to Firebase...</span>
                </div>
                
                <div id="messageContainer"></div>
                
                <!-- Authentication Form -->
                <form id="authForm" novalidate>
                    <div class="form-group">
                        <label for="emailInput" class="form-label">Email Address</label>
                        <input 
                            type="email" 
                            id="emailInput" 
                            class="form-input" 
                            placeholder="Enter your email address"
                            required 
                            autocomplete="email"
                            spellcheck="false"
                        >
                    </div>
                    
                    <div class="form-group">
                        <label for="passwordInput" class="form-label">Password</label>
                        <div class="password-container">
                            <input 
                                type="password" 
                                id="passwordInput" 
                                class="form-input" 
                                placeholder="Enter your password (6+ characters)"
                                required 
                                autocomplete="new-password"
                                minlength="6"
                            >
                            <button type="button" class="password-toggle" onclick="togglePasswordVisibility()">
                                <span id="passwordToggleIcon">👁️</span>
                            </button>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-primary" id="submitBtn">
                        <span class="btn-text" id="authBtnText">Create Account</span>
                    </button>
                </form>
                
                <button type="button" class="toggle-btn" onclick="toggleMode()">
                    <span id="toggleText">Already have an account? Sign In</span>
                </button>
                
                <div style="margin-top: 25px; font-size: 12px; color: var(--text-secondary); line-height: 1.4;">
                    By continuing, you agree to our Terms of Service and Privacy Policy.<br>
                    Your data is secured with Firebase Authentication.
                </div>
            </div>
        </div>

        <!-- Main App Interface -->
        <div id="mainApp" class="hidden">
            <div class="glass-interface">
                <!-- Header -->
                <div class="glass-header">
                    <div class="logo-section">
                        <div class="logo-text" style="font-size: 26px; font-weight: 200; color: var(--text-primary); letter-spacing: -1px;">JomBro</div>
                        <div class="logo-slogan">Let's Go! Let's Go!</div>
                        <div style="font-size: 9px; color: var(--text-secondary); margin-top: 2px; opacity: 0.8;" id="userDisplayName">Welcome!</div>
                    </div>
                    <div class="header-actions">
                        <button style="background: none; border: none; color: var(--text-secondary); font-size: 18px; cursor: pointer; padding: 8px; border-radius: 8px; transition: all 0.2s;" onclick="signOut()" title="Sign Out">🚪</button>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="glass-content">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <!-- Enhanced Stats Display -->
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px;">
                            <div class="stats-box" style="padding: 8px 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 10px; color: var(--text-secondary);">TOKENS</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--primary-pink);" id="userTokens">0</div>
                            </div>
                            <div class="stats-box" style="padding: 8px 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 10px; color: var(--text-secondary);">LEVEL</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--primary-purple);" id="userLevel">1</div>
                            </div>
                            <div class="stats-box" style="padding: 8px 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 10px; color: var(--text-secondary);">STREAK</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--primary-blue);" id="userStreak">0</div>
                            </div>
                            <div class="stats-box" style="padding: 8px 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 10px; color: var(--text-secondary);">RANK</div>
                                <div style="font-size: 16px; font-weight: 700; color: var(--success-green);" id="userRank">Beginner</div>
                            </div>
                        </div>
                        
                        <!-- XP Progress Bar -->
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                <span style="font-size: 12px; color: var(--text-secondary);">XP Progress</span>
                                <span style="font-size: 12px; color: var(--text-secondary);" id="xpProgress">0 / 1000</span>
                            </div>
                            <div style="background: rgba(255, 255, 255, 0.1); border-radius: 10px; overflow: hidden; height: 8px;">
                                <div style="height: 100%; background: linear-gradient(90deg, var(--primary-pink), var(--primary-purple)); width: 0%; transition: width 0.5s ease;" id="xpFill"></div>
                            </div>
                        </div>
                        
                        <!-- Energy & Gems -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                            <div class="stats-box" style="padding: 8px 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 10px; color: var(--text-secondary);">⚡ ENERGY</div>
                                <div style="font-size: 16px; font-weight: 700; color: #ff8c00;" id="userEnergy">100</div>
                            </div>
                            <div class="stats-box" style="padding: 8px 12px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 10px; color: var(--text-secondary);">💎 GEMS</div>
                                <div style="font-size: 16px; font-weight: 700; color: #00ff88;" id="userGems">0</div>
                            </div>
                        </div>
                        
                        <!-- Premium Status Banner -->
                        <div id="premiumBanner" style="display: none; background: transparent; border: 2px solid #ffd700; padding: 12px; border-radius: 12px; margin-bottom: 20px; text-align: center; color: #ffd700; font-weight: 700; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);">
                            <div style="font-size: 16px; margin-bottom: 5px;">👑 PREMIUM ACCOUNT ACTIVE</div>
                            <div style="font-size: 12px; opacity: 0.9;" id="premiumStatus">All features unlocked</div>
                        </div>
                        
                        <!-- Daily Rewards -->
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <span style="font-size: 14px; font-weight: 600; color: var(--text-primary);">🎁 Daily Rewards</span>
                                <button onclick="claimDailyReward()" id="dailyRewardBtn" class="btn-secondary" style="padding: 5px 10px; font-size: 12px;">Claim</button>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px;" id="dailyRewardsGrid"></div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div style="margin-bottom: 20px;">
                            <div style="font-size: 14px; font-weight: 600; margin-bottom: 10px; color: var(--text-primary);">⚡ Quick Actions</div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                                <button class="btn-secondary quick-action-btn" onclick="showShop()" style="padding: 8px; font-size: 12px;">🛒 Shop</button>
                                <button class="btn-secondary quick-action-btn" onclick="showFriends()" style="padding: 8px; font-size: 12px;">👥 Friends</button>
                                <button class="btn-secondary quick-action-btn" onclick="showStats()" style="padding: 8px; font-size: 12px;">📊 Stats</button>
                            </div>
                        </div>
                        
                        <!-- Power-ups -->
                        <div style="margin-bottom: 20px;">
                            <div style="font-size: 14px; font-weight: 600; margin-bottom: 10px; color: var(--text-primary);">💪 Active Power-ups</div>
                            <div id="activePowerUps" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;"></div>
                        </div>
                    </div>

                    <!-- AI Generated Challenges -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-primary);">
                            🤖 AI Generated Challenges
                            <span style="font-size: 10px; background: transparent; border: 1px solid var(--primary-pink); color: var(--primary-pink); padding: 2px 6px; border-radius: 8px; margin-left: 8px;">LIVE</span>
                        </div>
                        <div id="aiChallenges"></div>
                    </div>

                    <!-- Challenge Categories -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-primary);">🎮 Challenge Categories</div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 20px;">
                            <button class="category-btn" onclick="showChallenges('fitness')" style="border: 1px solid rgba(16, 185, 129, 0.3); color: #10b981; padding: 10px; border-radius: 8px; cursor: pointer;">
                                💪 Fitness
                            </button>
                            <button class="category-btn" onclick="showChallenges('mental')" style="border: 1px solid rgba(139, 92, 246, 0.3); color: #8b5cf6; padding: 10px; border-radius: 8px; cursor: pointer;">
                                🧠 Mental
                            </button>
                            <button class="category-btn" onclick="showChallenges('social')" style="border: 1px solid rgba(255, 107, 157, 0.3); color: #ff6b9d; padding: 10px; border-radius: 8px; cursor: pointer;">
                                👥 Social
                            </button>
                            <button class="category-btn" onclick="showChallenges('creative')" style="border: 1px solid rgba(245, 158, 11, 0.3); color: #f59e0b; padding: 10px; border-radius: 8px; cursor: pointer;">
                                🎨 Creative
                            </button>
                        </div>
                    </div>

                    <!-- Daily Challenges -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-primary);">🌟 Daily Challenges</div>
                        <div id="dailyChallenges"></div>
                    </div>

                    <!-- Weekly Challenges -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-primary);">🔥 Weekly Challenges</div>
                        <div id="weeklyChallenges"></div>
                    </div>

                    <!-- Leaderboard -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-primary);">🏆 Leaderboard</div>
                        <div id="leaderboard" style="background: transparent; backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 15px; padding: 20px;"></div>
                    </div>

                    <!-- Achievement System -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-primary);">🎖️ Achievements</div>
                        <div id="achievements" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 10px;"></div>
                    </div>

                    <!-- Profile Settings -->
                    <div style="margin-bottom: 25px;">
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-primary);">⚙️ Profile Settings</div>
                        <div style="background: transparent; backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 15px; padding: 20px;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                <span style="font-size: 14px;">🔔 Notifications</span>
                                <button onclick="toggleNotifications()" id="notificationToggle" class="settings-toggle" style="border: 2px solid var(--primary-pink); color: var(--primary-pink); padding: 5px 10px; border-radius: 5px; cursor: pointer;">ON</button>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                <span style="font-size: 14px;">🌙 Dark Mode</span>
                                <button onclick="toggleDarkMode()" id="darkModeToggle" class="settings-toggle" style="border: 2px solid var(--primary-purple); color: var(--primary-purple); padding: 5px 10px; border-radius: 5px; cursor: pointer;">ON</button>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <span style="font-size: 14px;">🔐 Privacy</span>
                                <button onclick="togglePrivacy()" id="privacyToggle" class="settings-toggle" style="border: 2px solid var(--primary-blue); color: var(--primary-blue); padding: 5px 10px; border-radius: 5px; cursor: pointer;">PRIVATE</button>
                            </div>
                        </div>
                    </div>

                    <!-- User Info Section -->
                    <div style="margin-top: 30px; text-align: center; color: var(--text-secondary);">
                        <div style="font-size: 14px; margin-bottom: 10px;">🎮 Account Status:</div>
                        <div style="font-size: 12px; line-height: 1.6;" id="accountInfo">
                            ✅ Authenticated with Firebase<br>
                            🔐 Account Secured<br>
                            🎯 Challenge System Active<br>
                            📊 Progress Tracking Ready<br>
                            🎨 Premium UI Experience
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Container -->
    <div id="modalContainer"></div>

    <!-- Firebase Scripts - Latest Version -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <script>
        console.log('🚀 JomBro Enhanced - Transparent UI Version with Firebase Auth');
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC_orriRUuf1ynDiFaJAPrO6-Gu3GeURxQ",
            authDomain: "jombro-9d129.firebaseapp.com",
            databaseURL: "https://jombro-9d129-default-rtdb.firebaseio.com",
            projectId: "jombro-9d129",
            storageBucket: "jombro-9d129.firebasestorage.app",
            messagingSenderId: "390572076435",
            appId: "1:390572076435:web:2a90027c66dc34d9834c66",
            measurementId: "G-YPQ5R5GLP8"
        };

        // Global State
        let firebaseApp = null;
        let firebaseAuth = null;
        let firebaseDb = null;
        let currentUser = null;
        let isSignUpMode = true;
        let isInitialized = false;
        let aiChallengeInterval = null;
        let onlinePlayersInterval = null;
        let isOnlinePlayersVisible = false;
        let userStats = {
            tokens: 0,
            level: 1,
            streak: 0,
            achievements: [],
            completedChallenges: [],
            accountType: 'standard',
            powerUps: [],
            friends: [],
            inventory: [],
            tournamentWins: 0,
            totalChallenges: 0,
            bestStreak: 0,
            rank: 'Beginner',
            xp: 0,
            gems: 0,
            energy: 100,
            dailyRewards: 0,
            badge: '🎮'
        };

        // Premium Founder Accounts
        const founderAccounts = {
            'stonne@jombro.com': {
                password: 'stonne123',
                displayName: 'Stonne',
                level: 10,
                tokens: 500000,
                streak: 365,
                accountType: 'founder',
                badge: '👑',
                achievements: ['first_challenge', 'token_collector', 'streak_master', 'social_butterfly', 'fitness_guru', 'mind_master', 'creative_genius', 'level_up'],
                specialPerks: ['unlimited_challenges', 'exclusive_content', 'priority_support', 'custom_themes'],
                joinDate: '2024-01-01'
            },
            'creator@jombro.com': {
                password: 'creator123',
                displayName: 'Pepp',
                level: 15,
                tokens: 1000000,
                streak: 500,
                accountType: 'master',
                badge: '🎯',
                achievements: ['first_challenge', 'token_collector', 'streak_master', 'social_butterfly', 'fitness_guru', 'mind_master', 'creative_genius', 'level_up'],
                specialPerks: ['admin_access', 'unlimited_challenges', 'exclusive_content', 'priority_support', 'custom_themes', 'challenge_creator'],
                joinDate: '2023-12-01'
            }
        };

        // Demo data
        const challengeCategories = {
            fitness: [
                { name: 'Morning Workout', description: 'Complete a 30-minute workout', tokens: 250, difficulty: 'Medium', time: '30min' },
                { name: '10,000 Steps', description: 'Walk 10,000 steps today', tokens: 200, difficulty: 'Easy', time: 'All day' },
                { name: 'Drink 8 Glasses', description: 'Drink 8 glasses of water', tokens: 150, difficulty: 'Easy', time: 'All day' },
                { name: 'Plank Challenge', description: 'Hold a plank for 2 minutes', tokens: 300, difficulty: 'Hard', time: '2min' }
            ],
            mental: [
                { name: 'Meditation', description: 'Meditate for 15 minutes', tokens: 200, difficulty: 'Easy', time: '15min' },
                { name: 'Read 20 Pages', description: 'Read 20 pages of a book', tokens: 250, difficulty: 'Medium', time: '30min' },
                { name: 'Learn Something New', description: 'Learn a new skill or fact', tokens: 300, difficulty: 'Medium', time: '45min' },
                { name: 'No Social Media', description: 'Avoid social media for 4 hours', tokens: 400, difficulty: 'Hard', time: '4hrs' }
            ],
            social: [
                { name: 'Call a Friend', description: 'Have a meaningful conversation', tokens: 200, difficulty: 'Easy', time: '20min' },
                { name: 'Help Someone', description: 'Do something kind for someone', tokens: 300, difficulty: 'Medium', time: '30min' },
                { name: 'Share Achievement', description: 'Share your progress with friends', tokens: 150, difficulty: 'Easy', time: '5min' },
                { name: 'Group Activity', description: 'Join a group activity or event', tokens: 350, difficulty: 'Medium', time: '1hr' }
            ],
            creative: [
                { name: 'Draw or Paint', description: 'Create some art for 30 minutes', tokens: 250, difficulty: 'Medium', time: '30min' },
                { name: 'Write a Story', description: 'Write a short story or poem', tokens: 300, difficulty: 'Medium', time: '45min' },
                { name: 'Take Photos', description: 'Take 10 creative photos', tokens: 200, difficulty: 'Easy', time: '30min' },
                { name: 'Music Practice', description: 'Practice an instrument or sing', tokens: 250, difficulty: 'Medium', time: '30min' }
            ]
        };

        // Firebase Initialization
        function initializeFirebase() {
            try {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                firebaseAuth = firebase.auth();
                firebaseDb = firebase.database();
                
                updateConnectionStatus('connected', 'Connected to Firebase');
                console.log('✅ Firebase initialized successfully');
                
                // Listen for auth state changes
                firebaseAuth.onAuthStateChanged((user) => {
                    if (user) {
                        currentUser = user;
                        console.log('👤 User signed in:', user.email);
                        
                        // Update display name
                        const userDisplayName = document.getElementById('userDisplayName');
                        if (userDisplayName) {
                            userDisplayName.textContent = `Welcome, ${user.displayName || getDisplayNameFromEmail(user.email)}!`;
                        }
                        
                        // Load user data and show main app
                        loadUserData(user);
                        showMainApp();
                        initializeAppFeatures();
                    } else {
                        currentUser = null;
                        console.log('👤 User signed out');
                        showAuthScreen();
                    }
                });
                
            } catch (error) {
                console.error('❌ Firebase initialization failed:', error);
                updateConnectionStatus('disconnected', 'Connection failed');
                showMessage('Failed to connect to Firebase. Please refresh the page.', 'error');
            }
        }

        // Authentication Functions
        async function handleAuth(email, password, isSignUp) {
            try {
                updateConnectionStatus('connecting', 'Authenticating...');
                
                // Check for founder accounts first
                if (founderAccounts[email] && founderAccounts[email].password === password) {
                    const founderData = founderAccounts[email];
                    console.log('🏆 Founder account detected:', founderData.displayName);
                    
                    // Apply founder stats
                    userStats = {
                        ...userStats,
                        ...founderData,
                        accountType: founderData.accountType,
                        badge: founderData.badge
                    };
                    
                    // Create/sign in founder account
                    let userCredential;
                    if (isSignUp) {
                        userCredential = await firebaseAuth.createUserWithEmailAndPassword(email, password);
                        await userCredential.user.updateProfile({
                            displayName: founderData.displayName
                        });
                    } else {
                        userCredential = await firebaseAuth.signInWithEmailAndPassword(email, password);
                    }
                    
                    showMessage(`🎉 Welcome ${founderData.displayName}! ${founderData.accountType === 'founder' ? 'Founder' : 'Master'} account activated!`, 'success');
                    return;
                }
                
                // Regular authentication
                let userCredential;
                if (isSignUp) {
                    userCredential = await firebaseAuth.createUserWithEmailAndPassword(email, password);
                    
                    // Set display name for new users
                    const displayName = getDisplayNameFromEmail(email);
                    await userCredential.user.updateProfile({
                        displayName: displayName
                    });
                    
                    showMessage(`🎉 Account created successfully! Welcome ${displayName}!`, 'success');
                } else {
                    userCredential = await firebaseAuth.signInWithEmailAndPassword(email, password);
                    showMessage(`👋 Welcome back, ${userCredential.user.displayName || getDisplayNameFromEmail(email)}!`, 'success');
                }
                
            } catch (error) {
                console.error('❌ Authentication error:', error);
                updateConnectionStatus('disconnected', 'Authentication failed');
                
                let errorMessage = 'Authentication failed. Please try again.';
                
                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'No account found with this email. Please sign up first.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Incorrect password. Please try again.';
                        break;
                    case 'auth/email-already-in-use':
                        errorMessage = 'An account with this email already exists. Please sign in instead.';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'Password should be at least 6 characters long.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Please enter a valid email address.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'Too many failed attempts. Please try again later.';
                        break;
                }
                
                showMessage(errorMessage, 'error');
            }
        }

        function loadUserData(user) {
            if (!firebaseDb || !user.uid) return;
            
            firebaseDb.ref(`users/${user.uid}/stats`).once('value')
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        userStats = { ...userStats, ...snapshot.val() };
                    } else {
                        firebaseDb.ref(`users/${user.uid}/stats`).set(userStats);
                    }
                    updateUserStatsDisplay();
                })
                .catch((error) => {
                    console.warn('⚠️ Failed to load user stats:', error);
                });
        }

        function getDisplayNameFromEmail(email) {
            const username = email.split('@')[0];
            return username.charAt(0).toUpperCase() + username.slice(1);
        }

        function signOut() {
            if (firebaseAuth) {
                firebaseAuth.signOut().then(() => {
                    showMessage('👋 See you later!', 'info');
                }).catch((error) => {
                    console.error('Sign out error:', error);
                });
            }
        }

        function showMainApp() {
            const authScreen = document.getElementById('authScreen');
            const mainApp = document.getElementById('mainApp');
            const rightButtons = document.getElementById('rightOverlayButtons');
            const topButtons = document.getElementById('topRightButtons');
            
            if (authScreen) authScreen.style.display = 'none';
            if (mainApp) {
                mainApp.classList.remove('hidden');
                mainApp.style.display = 'flex';
            }
            if (rightButtons) rightButtons.classList.remove('hidden');
            if (topButtons) topButtons.classList.remove('hidden');
        }

        function showAuthScreen() {
            const authScreen = document.getElementById('authScreen');
            const mainApp = document.getElementById('mainApp');
            const rightButtons = document.getElementById('rightOverlayButtons');
            const topButtons = document.getElementById('topRightButtons');
            const onlineOverlay = document.getElementById('onlinePlayersOverlay');
            
            if (authScreen) authScreen.style.display = 'block';
            if (mainApp) {
                mainApp.style.display = 'none';
                mainApp.classList.add('hidden');
            }
            if (rightButtons) rightButtons.classList.add('hidden');
            if (topButtons) topButtons.classList.add('hidden');
            if (onlineOverlay) onlineOverlay.classList.add('hidden');
            
            const authForm = document.getElementById('authForm');
            if (authForm) authForm.reset();
            
            const passwordInput = document.getElementById('passwordInput');
            const toggleIcon = document.getElementById('passwordToggleIcon');
            if (passwordInput) passwordInput.type = 'password';
            if (toggleIcon) toggleIcon.textContent = '👁️';
        }

        function initializeAppFeatures() {
            generateDailyChallenges();
            updateUserStatsDisplay();
            
            // Show premium banner for premium accounts
            const premiumBanner = document.getElementById('premiumBanner');
            const premiumStatus = document.getElementById('premiumStatus');
            
            if (premiumBanner && userStats.accountType !== 'standard') {
                premiumBanner.style.display = 'block';
                
                if (premiumStatus) {
                    const statusText = userStats.accountType === 'founder' ? 
                        'Founder Benefits • Unlimited Challenges • Priority Support' :
                        userStats.accountType === 'master' ? 
                        'Master Access • Admin Tools • Challenge Creator • All Premium Features' :
                        'Premium Features Unlocked';
                    premiumStatus.textContent = statusText;
                }
            }
        }

        function updateConnectionStatus(status, message) {
            const connectionStatus = document.getElementById('connectionStatus');
            if (!connectionStatus) return;
            
            connectionStatus.className = `connection-status ${status}`;
            
            const icons = {
                connecting: '🔄',
                connected: '🔥',
                disconnected: '❌'
            };
            
            connectionStatus.innerHTML = `
                <span>${icons[status] || '🔄'}</span>
                <span>${message}</span>
            `;
        }

        // Utility Functions
        function showMessage(message, type = 'info', duration = 3000) {
            const messageContainer = document.getElementById('messageContainer');
            if (!messageContainer) return;
            
            messageContainer.innerHTML = '';
            
            const messageEl = document.createElement('div');
            messageEl.className = `message ${type}`;
            messageEl.textContent = message;
            
            messageContainer.appendChild(messageEl);
            
            setTimeout(() => {
                if (messageEl.parentNode) {
                    messageEl.style.opacity = '0';
                    messageEl.style.transform = 'translateY(-10px)';
                    setTimeout(() => {
                        if (messageEl.parentNode) {
                            messageEl.remove();
                        }
                    }, 300);
                }
            }, duration);
        }

        function showModal(content) {
            const modalContainer = document.getElementById('modalContainer');
            if (!modalContainer) return;
            
            modalContainer.innerHTML = `
                <div class="modal-overlay" onclick="closeModal()">
                    <div class="modal-content" onclick="event.stopPropagation()">
                        ${content}
                    </div>
                </div>
            `;
        }

        function closeModal() {
            const modalContainer = document.getElementById('modalContainer');
            if (modalContainer) {
                modalContainer.innerHTML = '';
            }
        }

        function updateUserStatsDisplay() {
            const elements = {
                userTokens: document.getElementById('userTokens'),
                userLevel: document.getElementById('userLevel'),
                userStreak: document.getElementById('userStreak'),
                userRank: document.getElementById('userRank'),
                userEnergy: document.getElementById('userEnergy'),
                userGems: document.getElementById('userGems'),
                xpProgress: document.getElementById('xpProgress'),
                xpFill: document.getElementById('xpFill')
            };
            
            if (elements.userTokens) elements.userTokens.textContent = userStats.tokens.toLocaleString();
            if (elements.userLevel) elements.userLevel.textContent = userStats.level;
            if (elements.userStreak) elements.userStreak.textContent = userStats.streak;
            if (elements.userRank) elements.userRank.textContent = userStats.rank;
            if (elements.userEnergy) elements.userEnergy.textContent = userStats.energy;
            if (elements.userGems) elements.userGems.textContent = userStats.gems;
            
            const xpNeeded = userStats.level * 1000;
            const xpPercent = Math.min((userStats.xp / xpNeeded) * 100, 100);
            if (elements.xpProgress) elements.xpProgress.textContent = `${userStats.xp} / ${xpNeeded}`;
            if (elements.xpFill) elements.xpFill.style.width = `${xpPercent}%`;
        }

        function generateDailyChallenges() {
            const dailyChallenges = document.getElementById('dailyChallenges');
            if (!dailyChallenges) return;
            
            const categories = Object.keys(challengeCategories);
            const selectedChallenges = [];
            
            for (let i = 0; i < 3; i++) {
                const randomCategory = categories[Math.floor(Math.random() * categories.length)];
                const categoryChallenge = challengeCategories[randomCategory];
                const randomChallenge = categoryChallenge[Math.floor(Math.random() * categoryChallenge.length)];
                selectedChallenges.push({ ...randomChallenge, category: randomCategory });
            }
            
            dailyChallenges.innerHTML = selectedChallenges.map(challenge => `
                <div class="challenge-card" onclick="takeChallenge('${challenge.name}', ${challenge.tokens}, '${challenge.category}')">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px; color: var(--primary-pink);">
                        ${getCategoryIcon(challenge.category)} ${challenge.name}
                    </div>
                    <div style="font-size: 14px; line-height: 1.4; margin-bottom: 15px; opacity: 0.9; color: var(--text-secondary);">
                        ${challenge.description}
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px;">
                        <div style="text-align: center; background: transparent; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px;">
                            <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.tokens}</div>
                            <div style="font-size: 9px; color: var(--text-secondary);">TOKENS</div>
                        </div>
                        <div style="text-align: center; background: transparent; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px;">
                            <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.difficulty}</div>
                            <div style="font-size: 9px; color: var(--text-secondary);">LEVEL</div>
                        </div>
                        <div style="text-align: center; background: transparent; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px;">
                            <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.time}</div>
                            <div style="font-size: 9px; color: var(--text-secondary);">TIME</div>
                        </div>
                    </div>
                    <button class="btn-primary" style="width: 100%;">🚀 TAKE CHALLENGE</button>
                </div>
            `).join('');
        }

        function getCategoryIcon(category) {
            const icons = {
                fitness: '💪',
                mental: '🧠',
                social: '👥',
                creative: '🎨'
            };
            return icons[category] || '🎯';
        }

        // Feature Functions
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('passwordInput');
            const toggleIcon = document.getElementById('passwordToggleIcon');
            
            if (passwordInput && toggleIcon) {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    toggleIcon.textContent = '🙈';
                } else {
                    passwordInput.type = 'password';
                    toggleIcon.textContent = '👁️';
                }
            }
        }

        function toggleMode() {
            isSignUpMode = !isSignUpMode;
            const authBtnText = document.getElementById('authBtnText');
            const toggleText = document.getElementById('toggleText');
            
            if (authBtnText) {
                authBtnText.textContent = isSignUpMode ? 'Create Account' : 'Sign In';
            }
            
            if (toggleText) {
                toggleText.textContent = isSignUpMode ? 
                    'Already have an account? Sign In' : 
                    'Need an account? Sign Up';
            }
        }

        function signOut() {
            showMessage('👋 See you later!', 'info');
            setTimeout(() => {
                document.getElementById('authScreen').style.display = 'block';
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('rightOverlayButtons').classList.add('hidden');
                document.getElementById('topRightButtons').classList.add('hidden');
            }, 1000);
        }

        function takeChallenge(name, tokens, category) {
            userStats.tokens += tokens;
            userStats.xp += Math.floor(tokens * 0.5);
            userStats.streak += 1;
            
            updateUserStatsDisplay();
            showMessage(`🎉 Challenge "${name}" completed! +${tokens} tokens earned!`, 'success');
        }

        function showChallenges(category) {
            const challenges = challengeCategories[category] || [];
            const challengesHtml = challenges.map(challenge => `
                <div class="challenge-card" onclick="takeChallenge('${challenge.name}', ${challenge.tokens}, '${category}')">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px; color: var(--primary-pink);">
                        ${getCategoryIcon(category)} ${challenge.name}
                    </div>
                    <div style="font-size: 14px; line-height: 1.4; margin-bottom: 15px; opacity: 0.9; color: var(--text-secondary);">
                        ${challenge.description}
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px;">
                        <div style="text-align: center; background: transparent; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px;">
                            <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.tokens}</div>
                            <div style="font-size: 9px; color: var(--text-secondary);">TOKENS</div>
                        </div>
                        <div style="text-align: center; background: transparent; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px;">
                            <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.difficulty}</div>
                            <div style="font-size: 9px; color: var(--text-secondary);">LEVEL</div>
                        </div>
                        <div style="text-align: center; background: transparent; border: 1px solid rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px;">
                            <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.time}</div>
                            <div style="font-size: 9px; color: var(--text-secondary);">TIME</div>
                        </div>
                    </div>
                    <button class="btn-primary" style="width: 100%;">🚀 TAKE CHALLENGE</button>
                </div>
            `).join('');

            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">${getCategoryIcon(category)}</div>
                        <div>
                            <div class="feature-title">${category.charAt(0).toUpperCase() + category.slice(1)} Challenges</div>
                            <div class="feature-subtitle">Choose your challenge and get started!</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        ${challengesHtml}
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        // Settings Functions
        function toggleNotifications() {
            showMessage('🔔 Notification settings updated!', 'info');
        }

        function toggleDarkMode() {
            showMessage('🌙 Dark mode is always on!', 'info');
        }

        function togglePrivacy() {
            showMessage('🔐 Privacy settings updated!', 'info');
        }

        // Feature Functions that show modals
        function showCreateChallenge() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">➕</div>
                        <div>
                            <div class="feature-title">Create Challenge</div>
                            <div class="feature-subtitle">Design your own custom challenge</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <p style="color: var(--text-secondary); text-align: center;">
                            Create custom challenges for the community to enjoy! This feature allows you to design unique challenges with custom rewards and difficulty levels.
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function showMyTasks() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">📋</div>
                        <div>
                            <div class="feature-title">My Tasks</div>
                            <div class="feature-subtitle">Track your active challenges</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <p style="color: var(--text-secondary); text-align: center;">
                            View and manage all your active challenges in one place. Track progress, deadlines, and rewards for each task.
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function showSettings() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">⚙️</div>
                        <div>
                            <div class="feature-title">Settings</div>
                            <div class="feature-subtitle">Customize your JomBro experience</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <p style="color: var(--text-secondary); text-align: center;">
                            Adjust your preferences, notification settings, privacy controls, and personalize your JomBro experience.
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function showChampions() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">🏆</div>
                        <div>
                            <div class="feature-title">Champions</div>
                            <div class="feature-subtitle">Celebrate our top performers</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <p style="color: var(--text-secondary); text-align: center;">
                            View the hall of fame featuring our most dedicated challenge completers and community leaders.
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function showShames() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">😅</div>
                        <div>
                            <div class="feature-title">Hall of Shame</div>
                            <div class="feature-subtitle">Learn from mistakes</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <p style="color: var(--text-secondary); text-align: center;">
                            See missed challenges and broken streaks. Remember, every setback is a setup for a comeback!
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function showChat() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">💬</div>
                        <div>
                            <div class="feature-title">Global Chat</div>
                            <div class="feature-subtitle">Connect with the community</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <p style="color: var(--text-secondary); text-align: center;">
                            Chat with other challengers, share tips, motivate each other, and build lasting friendships!
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function showGroups() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">🏘️</div>
                        <div>
                            <div class="feature-title">Groups</div>
                            <div class="feature-subtitle">Join like-minded communities</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <p style="color: var(--text-secondary); text-align: center;">
                            Join groups based on your interests and challenge together with people who share your goals.
                        </p>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function showProfile() {
            showModal(`
                <div class="feature-modal">
                    <div class="feature-header">
                        <div class="feature-icon">👤</div>
                        <div>
                            <div class="feature-title">My Profile</div>
                            <div class="feature-subtitle">View your achievements and stats</div>
                        </div>
                    </div>
                    <div class="feature-content">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div style="width: 80px; height: 80px; border-radius: 50%; background: transparent; border: 3px solid var(--primary-pink); display: flex; align-items: center; justify-content: center; font-size: 32px; margin: 0 auto 15px;">🎮</div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 5px;">JomBro User</div>
                            <div style="font-size: 14px; color: var(--text-secondary);">Level ${userStats.level} • ${userStats.tokens} tokens</div>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="closeModal()" class="btn-primary">Close</button>
                    </div>
                </div>
            `);
        }

        function toggleOnlinePlayers() {
            const overlay = document.getElementById('onlinePlayersOverlay');
            if (!overlay) return;
            
            isOnlinePlayersVisible = !isOnlinePlayersVisible;
            
            if (isOnlinePlayersVisible) {
                overlay.classList.remove('hidden');
                overlay.innerHTML = `
                    <div class="online-players-header">
                        <div class="online-indicator"></div>
                        <span style="font-size: 14px; font-weight: 600;">Online Players</span>
                        <span style="font-size: 12px; color: var(--text-secondary);">5</span>
                    </div>
                    <div>
                        <div class="online-player">
                            <div class="player-avatar">🎮</div>
                            <div class="player-info">
                                <div class="player-name">You</div>
                                <div class="player-status">Online now</div>
                            </div>
                        </div>
                        <div class="online-player">
                            <div class="player-avatar">💪</div>
                            <div class="player-info">
                                <div class="player-name">FitnessGuru</div>
                                <div class="player-status">Completing workout</div>
                            </div>
                        </div>
                        <div class="online-player">
                            <div class="player-avatar">🧠</div>
                            <div class="player-info">
                                <div class="player-name">MindMaster</div>
                                <div class="player-status">Meditating</div>
                            </div>
                        </div>
                        <div class="online-player">
                            <div class="player-avatar">🎨</div>
                            <div class="player-info">
                                <div class="player-name">CreativeArt</div>
                                <div class="player-status">Drawing challenge</div>
                            </div>
                        </div>
                        <div class="online-player">
                            <div class="player-avatar">👥</div>
                            <div class="player-info">
                                <div class="player-name">SocialBee</div>
                                <div class="player-status">Helping others</div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                overlay.classList.add('hidden');
            }
        }

        function claimDailyReward() {
            userStats.tokens += 100;
            userStats.dailyRewards += 1;
            updateUserStatsDisplay();
            showMessage('🎁 Daily reward claimed! +100 tokens!', 'success');
        }

        function showShop() {
            showMessage('🛒 Shop feature coming soon!', 'info');
        }

        function showFriends() {
            showMessage('👥 Friends feature coming soon!', 'info');
        }

        function showStats() {
            showMessage('📊 Detailed stats coming soon!', 'info');
        }

        // Initialize the app
        function initializeApp() {
            updateUserStatsDisplay();
            generateDailyChallenges();
            
            // Show main app
            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('mainApp').classList.remove('hidden');
            document.getElementById('rightOverlayButtons').classList.remove('hidden');
            document.getElementById('topRightButtons').classList.remove('hidden');
            
            showMessage('🚀 Welcome to JomBro! Start your first challenge!', 'success');
        }

        // Auth form handler
        document.getElementById('authForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const emailInput = document.getElementById('emailInput');
            const passwordInput = document.getElementById('passwordInput');
            const submitBtn = document.getElementById('submitBtn');
            
            const email = emailInput.value.trim();
            const password = passwordInput.value;
            
            if (!email || !password) {
                showMessage('Please fill in all fields', 'error');
                return;
            }
            
            if (password.length < 6) {
                showMessage('Password must be at least 6 characters long', 'error');
                return;
            }
            
            submitBtn.classList.add('loading');
            
            handleAuth(email, password, isSignUpMode).finally(() => {
                submitBtn.classList.remove('loading');
            });
        });

        // Initialize Firebase on page load
        window.addEventListener('load', () => {
            console.log('🚀 JomBro Starting...');
            initializeFirebase();
        });
    </script>
</body>
</html>
