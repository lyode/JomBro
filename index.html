<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="JomBro">
    <meta name="theme-color" content="#ff6b9d">
    <meta name="description" content="AI-Powered Social Challenge Platform - Connect, Challenge, Conquer!">
       
    <title>JomBro - Cutting-Edge Layered Glass Interface</title>

    <style>
        /* ===== LAYERED GLASS SYSTEM ===== */
        
        :root {
            --safe-area-top: env(safe-area-inset-top, 20px);
            --safe-area-bottom: env(safe-area-inset-bottom, 20px);
            --primary-pink: #ff6b9d;
            --primary-purple: #8b5cf6;
            --primary-blue: #00d4ff;
            --accent-pink: #ff8cc8;
            --accent-purple: #a855f7;
            --accent-blue: #3b82f6;
            --dark-bg: #0a0a0a;
            --glass-bg: rgba(15, 15, 15, 0.45);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-shadow: rgba(0, 0, 0, 0.8);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --success-green: #10b981;
            --warning-orange: #f59e0b;
            --error-red: #ef4444;
            
            /* Glass Layer System */
            --glass-distance: 3mm;
            --glass-blur: 25px;
            --glass-opacity: 0.15;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            touch-action: manipulation;
        }

        html, body {
            height: 100vh;
            width: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: #000000;
            color: var(--text-primary);
            user-select: none;
            overflow: hidden;
            perspective: 1000px;
        }

        /* ===== BOTTOM LAYER: ANIMATED BACKGROUNDS ===== */
        
        .background-layer {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1;
            overflow: hidden;
            transform: translateZ(-var(--glass-distance));
        }

        .background-content {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .background-content.active {
            opacity: 1;
        }

        /* Space Background with Blinking Stars */
        .space-background {
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
            position: relative;
        }

        .stars {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
                radial-gradient(2px 2px at 160px 30px, #eee, transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: sparkle 3s linear infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .shooting-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 6px 2px rgba(255, 255, 255, 0.8);
            animation: shootingStar 4s linear infinite;
        }

        @keyframes shootingStar {
            0% {
                transform: translateX(-100px) translateY(-100px);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateX(100vw) translateY(100vh);
                opacity: 0;
            }
        }

        /* Space with Planets Background */
        .space-planets-background {
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
            position: relative;
        }

        .planet {
            position: absolute;
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .planet-1 {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at 30% 30%, #ff6b9d, #c44569);
            top: 20%;
            right: 15%;
            animation-delay: 0s;
        }

        .planet-2 {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #8b5cf6, #5b21b6);
            bottom: 30%;
            left: 10%;
            animation-delay: 2s;
        }

        .planet-3 {
            width: 40px;
            height: 40px;
            background: radial-gradient(circle at 30% 30%, #00d4ff, #0284c7);
            top: 50%;
            left: 50%;
            animation-delay: 4s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        /* Animated Background */
        .animated-background {
            background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460);
            position: relative;
        }

        .animated-shape {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-pink), var(--primary-purple));
            opacity: 0.1;
            animation: morphShapes 8s ease-in-out infinite;
        }

        .shape-1 {
            width: 100px;
            height: 100px;
            top: 20%;
            left: 20%;
            animation-delay: 0s;
        }

        .shape-2 {
            width: 150px;
            height: 150px;
            bottom: 20%;
            right: 20%;
            animation-delay: 2s;
        }

        .shape-3 {
            width: 80px;
            height: 80px;
            top: 60%;
            left: 60%;
            animation-delay: 4s;
        }

        @keyframes morphShapes {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                border-radius: 50%;
            }
            25% {
                transform: scale(1.2) rotate(90deg);
                border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            }
            50% {
                transform: scale(0.8) rotate(180deg);
                border-radius: 70% 30% 30% 70% / 70% 70% 30% 30%;
            }
            75% {
                transform: scale(1.1) rotate(270deg);
                border-radius: 50% 50% 25% 75% / 25% 75% 50% 50%;
            }
        }

        /* Video Background */
        .video-background {
            position: relative;
        }

        .video-background video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translateX(-50%) translateY(-50%);
            object-fit: cover;
            opacity: 0.6;
        }

        /* ===== TOP LAYER: GLASS UI INTERFACE ===== */
        
        .glass-layer {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            transform: translateZ(var(--glass-distance));
            transform-style: preserve-3d;
            will-change: transform;
            pointer-events: auto;
        }

        /* Background Controls */
        .background-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
            display: flex;
            gap: 10px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bg-control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
        }

        .bg-control-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.2);
        }

        .bg-control-btn.active {
            background: var(--primary-pink);
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.5);
        }

        /* Auth Screen with Glass Effect */
        .auth-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            padding: 20px;
            backdrop-filter: blur(var(--glass-blur));
            background: rgba(0, 0, 0, 0.4);
        }

        .auth-container {
            background: rgba(15, 15, 15, 0.3);
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 40px 30px;
            text-align: center;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            max-width: 350px;
            width: 100%;
            transform: translateZ(5px);
        }

        .auth-logo {
            font-size: 48px;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 107, 157, 0.5);
        }

        .auth-title {
            font-size: 28px;
            font-weight: 300;
            color: var(--text-primary);
            margin-bottom: 8px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .auth-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 30px;
        }

        .auth-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .auth-btn.google {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 8px 32px rgba(255, 255, 255, 0.1);
        }

        .auth-btn.facebook {
            background: rgba(24, 119, 242, 0.8);
            color: #fff;
            box-shadow: 0 8px 32px rgba(24, 119, 242, 0.3);
        }

        .auth-btn.phone {
            background: rgba(255, 107, 157, 0.8);
            color: #fff;
            box-shadow: 0 8px 32px rgba(255, 107, 157, 0.3);
        }

        .auth-btn.test {
            background: rgba(102, 102, 102, 0.8);
            color: white;
            box-shadow: 0 8px 32px rgba(102, 102, 102, 0.3);
        }

        .auth-btn:hover {
            transform: translateY(-2px) translateZ(2px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.3);
        }

        /* Main App with Glass Effect */
        .phone-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        .glass-interface {
            width: 100%;
            max-width: 400px;
            height: calc(100vh - 20px);
            background: rgba(15, 15, 15, 0.25);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 25px;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 0 60px rgba(255, 107, 157, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            transform: translateZ(3px);
        }

        .glass-header {
            position: sticky;
            top: 0;
            z-index: 100;
            padding: calc(var(--safe-area-top) + 20px) 25px 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            background: rgba(15, 15, 15, 0.4);
            backdrop-filter: blur(40px);
        }

        .logo-section {
            display: flex;
            flex-direction: column;
            cursor: pointer;
        }

        .logo-text {
            font-size: 26px;
            font-weight: 200;
            color: var(--text-primary);
            letter-spacing: -1px;
            text-shadow: 0 0 20px rgba(255, 107, 157, 0.4);
        }

        .logo-slogan {
            font-size: 10px;
            color: var(--primary-pink);
            margin-top: -2px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.9;
            animation: pulse 3s infinite;
            text-shadow: 0 0 10px rgba(255, 107, 157, 0.6);
        }

        .logo-subtitle {
            font-size: 9px;
            color: var(--text-secondary);
            margin-top: 2px;
            opacity: 0.8;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .header-btn {
            width: 30px;
            height: 30px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-primary);
            transition: all 0.3s ease;
            position: relative;
        }

        .header-btn:hover {
            background: rgba(255, 107, 157, 0.15);
            border-color: var(--primary-pink);
            transform: scale(1.1) translateZ(1px);
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.3);
        }

        .notification-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 16px;
            height: 16px;
            background: var(--primary-pink);
            border-radius: 50%;
            font-size: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            box-shadow: 0 0 10px rgba(255, 107, 157, 0.5);
        }

        .glass-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        .glass-section {
            padding: 15px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(20px);
        }

        .live-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background: #ff4757;
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px #ff4757;
        }

        @keyframes pulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 0 0 10px rgba(255, 71, 87, 0.8);
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.02);
                box-shadow: 0 0 20px rgba(255, 71, 87, 1);
            }
        }

        .user-status {
            background: rgba(255, 107, 157, 0.1);
            border: 1px solid rgba(255, 107, 157, 0.3);
            color: var(--primary-pink);
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            backdrop-filter: blur(15px);
            box-shadow: 0 0 15px rgba(255, 107, 157, 0.2);
        }

        .live-players {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .player-avatar {
            position: relative;
            flex-shrink: 0;
        }

        .avatar-ring {
            width: 44px;
            height: 44px;
            border-radius: 22px;
            background: linear-gradient(45deg, var(--primary-pink), var(--primary-purple));
            padding: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.3);
        }

        .avatar-ring:hover {
            transform: scale(1.1) translateZ(2px);
            box-shadow: 0 0 30px rgba(255, 107, 157, 0.5);
        }

        .avatar-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            overflow: hidden;
        }

        .avatar-status {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 10px;
            height: 10px;
            background: var(--success-green);
            border: 2px solid rgba(10, 10, 10, 0.8);
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 8px var(--success-green);
        }

        /* Enhanced Modal System */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 20px;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: rgba(15, 15, 15, 0.3);
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            width: 100%;
            max-width: 400px;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.7),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transform: translateZ(5px);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: var(--text-primary);
            transform: scale(1.1);
        }

        /* Enhanced Buttons */
        .btn-primary {
            background: linear-gradient(145deg, rgba(255, 107, 157, 0.8), rgba(196, 69, 105, 0.8));
            backdrop-filter: blur(20px);
            color: #fff;
            border: 1px solid rgba(255, 107, 157, 0.3);
            padding: 16px 24px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 
                0 6px 20px rgba(255, 107, 157, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .btn-primary:hover {
            transform: translateY(-3px) translateZ(2px);
            box-shadow: 
                0 8px 25px rgba(255, 107, 157, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px) translateZ(1px);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        /* Challenge Cards with Enhanced Glass Effect */
        .challenge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .challenge-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .challenge-card:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateY(-5px) translateZ(3px);
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.4),
                0 0 30px rgba(255, 107, 157, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .challenge-category-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Form Elements with Glass Effect */
        .form-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-pink);
            box-shadow: 0 0 0 2px rgba(255, 107, 157, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-input::placeholder {
            color: var(--text-secondary);
        }

        /* Enhanced Chat Interface */
        .chat-interface {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: rgba(15, 15, 15, 0.3);
            backdrop-filter: blur(40px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px 20px 0 0;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.5);
        }

        .chat-interface.open {
            transform: translateY(0);
        }

        .chat-toggle {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: rgba(255, 107, 157, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 107, 157, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #fff;
            cursor: pointer;
            box-shadow: 
                0 4px 20px rgba(255, 107, 157, 0.4),
                0 0 30px rgba(255, 107, 157, 0.3);
            z-index: 1001;
            transition: all 0.3s ease;
        }

        .chat-toggle:hover {
            transform: scale(1.1) translateZ(2px);
            box-shadow: 
                0 6px 25px rgba(255, 107, 157, 0.5),
                0 0 40px rgba(255, 107, 157, 0.4);
        }

        /* Settings Modal Styles */
        .settings-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .setting-item:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .setting-info {
            flex: 1;
        }

        .setting-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 3px;
        }

        .setting-desc {
            font-size: 11px;
            color: var(--text-secondary);
            line-height: 1.3;
        }

        .toggle-switch {
            width: 50px;
            height: 26px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .toggle-switch:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .toggle-slider {
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 3px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .toggle-slider.active {
            left: 26px;
            background: var(--primary-pink);
            box-shadow: 
                0 2px 8px rgba(255, 107, 157, 0.4),
                0 0 15px rgba(255, 107, 157, 0.3);
        }

        .toggle-switch.active {
            background: rgba(255, 107, 157, 0.2);
            border-color: rgba(255, 107, 157, 0.4);
        }

        /* Feature Hide/Show Classes */
        .feature-hidden {
            display: none !important;
        }

        .glass-reduced {
            backdrop-filter: blur(5px) !important;
        }

        .animations-disabled * {
            animation: none !important;
            transition: none !important;
        }

        .hover-disabled:hover {
            transform: none !important;
            box-shadow: none !important;
        }

        /* Performance Mode Styles */
        .performance-mode .glass-interface,
        .performance-mode .modal-content,
        .performance-mode .auth-container {
            backdrop-filter: blur(10px) !important;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
        }

        .performance-mode .background-content {
            opacity: 0.3 !important;
        }

        .performance-mode * {
            animation-duration: 0.1s !important;
            transition-duration: 0.1s !important;
        }

        /* Battery Saver Mode */
        .battery-saver .background-content {
            opacity: 0.1 !important;
        }

        .battery-saver * {
            animation: none !important;
            transition: none !important;
        }

        .battery-saver .glass-interface,
        .battery-saver .modal-content {
            backdrop-filter: blur(5px) !important;
        }

        /* Background Options in Profile */
        .background-option {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
        }

        .background-option:hover {
            transform: translateY(-3px);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .background-option.active {
            border-color: var(--primary-pink);
            box-shadow: 
                0 8px 25px rgba(255, 107, 157, 0.3),
                0 0 20px rgba(255, 107, 157, 0.2);
        }

        .bg-preview {
            position: relative;
            height: 60px;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
        }

        .bg-option-label {
            padding: 8px;
            text-align: center;
            color: var(--text-primary);
        }

        /* Profile Image Upload Hover Effect */
        .profile-avatar-upload:hover .avatar-upload-overlay {
            transform: translateY(0);
        }

        /* Enhanced Profile Sections */
        .profile-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .profile-section h3 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        /* Utility Classes */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            color: var(--text-primary);
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        /* Performance Optimizations */
        .glass-layer * {
            will-change: transform;
            backface-visibility: hidden;
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .glass-interface {
                max-width: 100%;
                height: 100vh;
                border-radius: 0;
                margin: 0;
            }
            
            .phone-container {
                padding: 0;
            }
            
            .background-controls {
                top: 10px;
                right: 10px;
                transform: scale(0.9);
            }
        }

        /* File Upload Styling */
        input[type="file"] {
            display: none;
        }

        .file-upload-btn {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }

        .file-upload-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--primary-pink);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <!-- Bottom Layer: Animated Backgrounds -->
    <div class="background-layer">
        <!-- Space with Blinking Stars -->
        <div class="background-content space-background active" id="spaceBackground">
            <div class="stars"></div>
            <div class="shooting-star" style="top: 20%; left: 10%;"></div>
            <div class="shooting-star" style="top: 60%; left: 30%; animation-delay: 2s;"></div>
            <div class="shooting-star" style="top: 80%; left: 60%; animation-delay: 4s;"></div>
        </div>

        <!-- Space with Planets -->
        <div class="background-content space-planets-background" id="spacePlanetsBackground">
            <div class="stars"></div>
            <div class="planet planet-1"></div>
            <div class="planet planet-2"></div>
            <div class="planet planet-3"></div>
        </div>

        <!-- Animated Shapes -->
        <div class="background-content animated-background" id="animatedBackground">
            <div class="animated-shape shape-1"></div>
            <div class="animated-shape shape-2"></div>
            <div class="animated-shape shape-3"></div>
        </div>

        <!-- Custom Video Background -->
        <div class="background-content video-background" id="videoBackground">
            <video autoplay muted loop id="customVideo">
                <!-- Video source will be added dynamically -->
            </video>
        </div>
    </div>



    <!-- Top Layer: Glass UI Interface -->
    <div class="glass-layer">
        <!-- Auth Screen -->
        <div id="authScreen" class="auth-screen">
            <div class="auth-container">
                <div class="auth-logo">üöÄ</div>
                <div class="auth-title">Welcome to JomBro</div>
                <div class="auth-subtitle">Connect with friends and tackle challenges together!</div>
                
                <div id="errorMessage" class="error-message" style="display: none;"></div>
                <div id="successMessage" class="success-message" style="display: none;"></div>
                
                <!-- Main Auth Screen -->
                <div id="mainAuth">
                    <button class="auth-btn google" onclick="signInWithGoogle()">
                        üîç Continue with Google
                    </button>
                    
                    <button class="auth-btn facebook" onclick="signInWithFacebook()">
                        üìò Continue with Facebook
                    </button>
                    
                    <button class="auth-btn phone" onclick="showPhoneForm()">
                        üì± Continue with Phone
                    </button>
                    
                    <button class="auth-btn test" onclick="signInAnonymously()">
                        üß™ Test Mode (Skip Login)
                    </button>
                </div>

                <!-- Phone Form -->
                <div id="phoneForm" style="display: none; margin-top: 20px;">
                    <input type="tel" id="phoneInput" class="form-input" placeholder="+60123456789" required>
                    <div id="recaptcha-container"></div>
                    <input type="text" id="otpInput" class="form-input" placeholder="Enter OTP" style="display:none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
                        <button class="btn-secondary" onclick="showMainAuth()">Back</button>
                        <button class="btn-primary" id="phoneSubmitBtn" onclick="signInWithPhone()">Send OTP</button>
                    </div>
                </div>

                <!-- User Info (After Login) -->
                <div id="userInfo" style="display: none;">
                    <h3 style="color: var(--text-primary); margin-bottom: 15px;">Welcome!</h3>
                    <p id="userDetails" style="color: var(--text-secondary); margin-bottom: 20px;"></p>
                    <button class="btn-primary" onclick="signOut()">Sign Out</button>
                </div>
                
                <div style="margin-top: 20px; font-size: 12px; color: var(--text-secondary);">
                    By continuing, you agree to our Terms & Privacy Policy
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="mainApp" class="phone-container" style="display: none;">
            <div class="glass-interface">
                <!-- Header -->
                <div class="glass-header">
                    <div class="logo-section" onclick="showProfile()">
                        <div class="logo-text">JomBro</div>
                        <div class="logo-slogan">Let's go! Let's Go!</div>
                        <div class="logo-subtitle" id="userDisplayName">Loading...</div>
                    </div>
                    <div class="header-actions">
                        <div class="header-btn" onclick="showMyTasks()" title="My Tasks">
                            üìã
                            <div class="notification-badge" id="tasksNotifications" style="display: none;">2</div>
                        </div>
                        <div class="header-btn" onclick="toggleChat()" title="Group Chat">
                            üí¨
                            <div class="notification-badge" id="chatNotifications" style="display: none;">3</div>
                        </div>
                        <div class="header-btn" onclick="showOnlineUsers()" title="Online Users">
                            üë•
                            <div class="notification-badge" id="onlineUsersNotifications">5</div>
                        </div>
                        <div class="header-btn" onclick="showGroups()" title="Groups">üè†</div>
                        <div class="header-btn" onclick="showEnhancedProfile()" title="Enhanced Profile">üë§</div>
                        <div class="header-btn" onclick="showSettings()" title="Settings">‚öôÔ∏è</div>
                        <div class="header-btn" onclick="signOut()" title="Sign Out">üö™</div>
                    </div>
                </div>

                <div class="glass-content">
                    <!-- Live Players Section -->
                    <div class="glass-section">
                        <div class="live-header">
                            <div class="live-indicator">
                                <div class="live-dot"></div>
                                <span>LIVE</span>
                                <span class="online-count" id="onlineCount" style="background: rgba(0, 255, 150, 0.2); color: var(--success-green); padding: 2px 8px; border-radius: 10px; font-size: 10px; margin-left: 8px;">5 online</span>
                            </div>
                            <div class="user-status" id="userStatus" onclick="showProfile()">
                                <span id="userLevel">Level 1</span>
                            </div>
                        </div>
                        <div class="live-players" id="livePlayersContainer">
                            <!-- Real users appear here -->
                        </div>
                    </div>

                    <!-- Current Challenge Status -->
                    <div id="currentChallengeStatus" class="glass-section" style="display: none;">
                        <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px; padding: 15px; margin: 15px 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div>
                                    <div style="padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; background: var(--success-green); color: white; display: inline-block;">In Progress</div>
                                    <div style="font-size: 14px; font-weight: 600; margin-top: 5px;" id="currentChallengeTitle">Coffee Shop Poetry Challenge</div>
                                </div>
                                <div style="font-size: 18px; font-weight: 700; color: var(--primary-pink);" id="challengeTimer">2h 45m left</div>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">
                                <span id="challengeProgress">Ready to submit proof</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn-secondary" onclick="submitProof()" style="flex: 1;">üì∏ Submit Proof</button>
                                <button class="btn-secondary" onclick="viewChallenge()" style="flex: 1;">üëÄ View Details</button>
                            </div>
                        </div>
                    </div>

                    <!-- Main Challenge Selection -->
                    <div style="flex: 1; padding: 20px 25px; min-height: 300px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <h3 style="font-size: 18px; font-weight: 600; color: var(--text-primary);">üéØ Choose Your Challenge</h3>
                                <div style="background: rgba(255, 255, 255, 0.1); color: var(--text-secondary); padding: 4px 8px; border-radius: 8px; font-size: 10px; backdrop-filter: blur(10px);">AI Generated</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="refreshChallenges()" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: var(--text-primary); padding: 6px 8px; border-radius: 8px; cursor: pointer; font-size: 12px; backdrop-filter: blur(15px);" title="Generate New">‚ú®</button>
                            </div>
                        </div>
                        
                        <div id="challengeSelection" class="challenge-grid">
                            <!-- AI Generated challenges appear here -->
                        </div>
                    </div>

                    <!-- Action Section -->
                    <div style="padding: 18px 25px; background: linear-gradient(180deg, transparent 0%, rgba(255, 255, 255, 0.03) 100%); border-top: 1px solid rgba(255, 255, 255, 0.06);">
                        <div style="text-align: center; margin-bottom: 15px;">
                            <div style="font-size: 14px; font-weight: 600; margin-bottom: 5px; color: var(--text-primary);">Ready to start your challenge journey?</div>
                            <div style="font-size: 11px; color: var(--text-secondary);">Click the button below to begin, then choose your challenge!</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                            <button class="btn-secondary" onclick="showSubmissionGallery()" style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                üèÜ My Gallery
                            </button>
                            <button class="btn-secondary" onclick="showMyTasks()" style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                üìã My Tasks
                            </button>
                        </div>
                        <button class="btn-primary" id="mainActionBtn" onclick="showChallengeAgreement()">
                            üéØ CHALLENGE
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Modals (same as before but with glass effect) -->
        <div id="enhancedProfileModal" class="modal">
            <div class="modal-content" style="max-width: 500px;">
                <div class="modal-header">
                    <div class="modal-title">üë§ Enhanced Profile</div>
                    <button class="modal-close" onclick="hideModal('enhancedProfile')">&times;</button>
                </div>

                <!-- Profile Header Section -->
                <div style="background: linear-gradient(135deg, var(--primary-pink), var(--primary-purple)); padding: 25px; border-radius: 20px; margin-bottom: 25px; color: white; position: relative; overflow: hidden;">
                    <div style="position: relative; width: 80px; height: 80px; margin: 0 auto 15px; cursor: pointer;" onclick="uploadProfilePicture()">
                        <div style="width: 80px; height: 80px; border-radius: 50%; background: rgba(255, 255, 255, 0.2); display: flex; align-items: center; justify-content: center; font-size: 28px; border: 3px solid rgba(255, 255, 255, 0.3); transition: all 0.3s ease; overflow: hidden;">
                            <img id="profileImage" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; display: none;">
                            <span id="profileInitials">USER</span>
                        </div>
                        <div style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0, 0, 0, 0.7); color: white; text-align: center; padding: 4px; font-size: 9px; transform: translateY(100%); transition: transform 0.3s ease;">
                            üì∑ Upload Photo
                        </div>
                        <input type="file" id="profileImageInput" accept="image/*" style="display: none;" onchange="handleProfileImageUpload(event)">
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="font-size: 20px; font-weight: 700; margin-bottom: 5px; cursor: pointer;" id="enhancedProfileName" onclick="editProfileName()">Demo User</div>
                        <div style="font-size: 11px; opacity: 0.9; margin-bottom: 15px; cursor: pointer;" id="enhancedProfileBio" onclick="editProfileBio()">Challenge enthusiast ready to take on the world! üöÄ</div>
                        <div style="display: flex; justify-content: center; gap: 15px; font-size: 11px;">
                            <div><strong id="profileTokensDisplay">1,250</strong> Tokens</div>
                            <div><strong id="profileLevelDisplay">Level 3</strong></div>
                            <div><strong id="profileStreakDisplay">7</strong> Day Streak</div>
                        </div>
                    </div>
                </div>

                <!-- Background Customization Section -->
                <div style="margin-bottom: 25px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--primary-pink); display: flex; align-items: center; gap: 8px;">
                        üé® Background Themes
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 15px;">
                        <div class="background-option active" onclick="switchBackground('space')" data-bg="space">
                            <div class="bg-preview space-preview">
                                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);"></div>
                                <div style="position: absolute; top: 20%; left: 20%; width: 2px; height: 2px; background: white; border-radius: 50%; animation: sparkle 2s infinite;"></div>
                                <div style="position: absolute; top: 40%; right: 30%; width: 1px; height: 1px; background: white; border-radius: 50%; animation: sparkle 3s infinite;"></div>
                                <div style="position: absolute; bottom: 30%; left: 40%; width: 2px; height: 2px; background: white; border-radius: 50%; animation: sparkle 1.5s infinite;"></div>
                            </div>
                            <div class="bg-option-label">
                                <div style="font-size: 18px;">‚ú®</div>
                                <div style="font-size: 11px; font-weight: 600;">Space Stars</div>
                            </div>
                        </div>

                        <div class="background-option" onclick="switchBackground('planets')" data-bg="planets">
                            <div class="bg-preview planets-preview">
                                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);"></div>
                                <div style="position: absolute; top: 20%; right: 20%; width: 12px; height: 12px; background: radial-gradient(circle, #ff6b9d, #c44569); border-radius: 50%;"></div>
                                <div style="position: absolute; bottom: 30%; left: 25%; width: 8px; height: 8px; background: radial-gradient(circle, #8b5cf6, #5b21b6); border-radius: 50%;"></div>
                            </div>
                            <div class="bg-option-label">
                                <div style="font-size: 18px;">ü™ê</div>
                                <div style="font-size: 11px; font-weight: 600;">Space Planets</div>
                            </div>
                        </div>

                        <div class="background-option" onclick="switchBackground('animated')" data-bg="animated">
                            <div class="bg-preview animated-preview">
                                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460);"></div>
                                <div style="position: absolute; top: 25%; left: 25%; width: 15px; height: 15px; background: linear-gradient(45deg, var(--primary-pink), var(--primary-purple)); border-radius: 50%; opacity: 0.3;"></div>
                                <div style="position: absolute; bottom: 30%; right: 30%; width: 10px; height: 10px; background: linear-gradient(45deg, var(--primary-blue), var(--primary-purple)); border-radius: 50%; opacity: 0.3;"></div>
                            </div>
                            <div class="bg-option-label">
                                <div style="font-size: 18px;">üé®</div>
                                <div style="font-size: 11px; font-weight: 600;">Abstract Art</div>
                            </div>
                        </div>

                        <div class="background-option" onclick="document.getElementById('videoUpload').click()" data-bg="video">
                            <div class="bg-preview video-preview">
                                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 16px;">üìπ</div>
                            </div>
                            <div class="bg-option-label">
                                <div style="font-size: 18px;">üìπ</div>
                                <div style="font-size: 11px; font-weight: 600;">Custom Video</div>
                            </div>
                        </div>
                    </div>
                    <input type="file" id="videoUpload" accept="video/*" style="display: none;" onchange="handleVideoUpload(event)">
                    
                    <div style="font-size: 10px; color: var(--text-secondary); text-align: center; opacity: 0.8;">
                        Choose your preferred background theme for the ultimate experience
                    </div>
                </div>

                <!-- Quick Stats & Achievements -->
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: var(--primary-purple); display: flex; align-items: center; gap: 8px;">
                        üèÜ Recent Achievements
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(70px, 1fr)); gap: 8px;">
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 10px 6px; text-align: center; transition: all 0.3s ease; cursor: pointer;" title="Welcome to JomBro!">
                            <div style="font-size: 20px; margin-bottom: 3px;">üåü</div>
                            <div style="font-size: 8px; opacity: 0.9;">New Member</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 10px 6px; text-align: center; transition: all 0.3s ease; cursor: pointer;" title="First Challenge Completed">
                            <div style="font-size: 20px; margin-bottom: 3px;">üöÄ</div>
                            <div style="font-size: 8px; opacity: 0.9;">Challenger</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 10px 6px; text-align: center; transition: all 0.3s ease; cursor: pointer;" title="Social Butterfly">
                            <div style="font-size: 20px; margin-bottom: 3px;">ü¶ã</div>
                            <div style="font-size: 8px; opacity: 0.9;">Social Star</div>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 10px 6px; text-align: center; transition: all 0.3s ease; cursor: pointer;" title="Week Streak">
                            <div style="font-size: 20px; margin-bottom: 3px;">üî•</div>
                            <div style="font-size: 8px; opacity: 0.9;">On Fire</div>
                        </div>
                    </div>
                </div>

                <!-- Profile Actions -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                    <button class="btn-secondary" onclick="editEnhancedProfile()" style="font-size: 12px;">‚úèÔ∏è Edit</button>
                    <button class="btn-secondary" onclick="shareProfile()" style="font-size: 12px;">üì§ Share</button>
                    <button class="btn-secondary" onclick="viewFullStats()" style="font-size: 12px;">üìä Stats</button>
                </div>
            </div>
        </div>

        <div id="myTasksModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">üìã My Tasks</div>
                    <button class="modal-close" onclick="hideModal('myTasks')">&times;</button>
                </div>
                <div id="myTasksList" style="padding: 20px; text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 15px;">üìã</div>
                    <div style="font-size: 16px; margin-bottom: 8px; color: var(--text-primary);">No active tasks</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Accept a challenge to get started!</div>
                </div>
            </div>
        </div>

        <div id="challengeAgreementModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">üéØ Ready for a Challenge?</div>
                    <button class="modal-close" onclick="hideModal('challengeAgreement')">&times;</button>
                </div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 48px; margin-bottom: 10px;">üöÄ</div>
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px; color: var(--primary-pink);">Take on a New Challenge!</div>
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;">Choose from our AI-generated challenges and start your adventure!</div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button class="btn-secondary" onclick="hideModal('challengeAgreement')">Maybe Later</button>
                    <button class="btn-primary" onclick="agreeToChallenge()">üéØ I'M READY!</button>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal">
            <div class="modal-content" style="max-width: 450px;">
                <div class="modal-header">
                    <div class="modal-title">‚öôÔ∏è Settings & Customization</div>
                    <button class="modal-close" onclick="hideModal('settings')">&times;</button>
                </div>

                <!-- UI Features Section -->
                <div style="margin-bottom: 25px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--primary-pink); display: flex; align-items: center; gap: 8px;">
                        üé® Interface Features
                    </h3>
                    
                    <div class="settings-group">
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Live Players Section</div>
                                <div class="setting-desc">Show online users and live activity</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('livePlayersSection')">
                                <div class="toggle-slider active" id="livePlayersSectionToggle"></div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Challenge Status Bar</div>
                                <div class="setting-desc">Display current challenge progress</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('challengeStatus')">
                                <div class="toggle-slider active" id="challengeStatusToggle"></div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Chat Features</div>
                                <div class="setting-desc">Enable group chat and messaging</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('chatFeatures')">
                                <div class="toggle-slider active" id="chatFeaturesToggle"></div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Notification Badges</div>
                                <div class="setting-desc">Show red notification dots on buttons</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('notifications')">
                                <div class="toggle-slider active" id="notificationsToggle"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visual Effects Section -->
                <div style="margin-bottom: 25px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--primary-purple); display: flex; align-items: center; gap: 8px;">
                        ‚ú® Visual Effects
                    </h3>
                    
                    <div class="settings-group">
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Glass Blur Effect</div>
                                <div class="setting-desc">Enhanced glassmorphism with blur</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('glassBlur')">
                                <div class="toggle-slider active" id="glassBlurToggle"></div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Background Animations</div>
                                <div class="setting-desc">Animated stars, planets, and shapes</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('backgroundAnimations')">
                                <div class="toggle-slider active" id="backgroundAnimationsToggle"></div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Button Hover Effects</div>
                                <div class="setting-desc">Glowing and scaling animations</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('hoverEffects')">
                                <div class="toggle-slider active" id="hoverEffectsToggle"></div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Particle Effects</div>
                                <div class="setting-desc">Shooting stars and floating particles</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('particleEffects')">
                                <div class="toggle-slider active" id="particleEffectsToggle"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Section -->
                <div style="margin-bottom: 25px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--primary-blue); display: flex; align-items: center; gap: 8px;">
                        ‚ö° Performance
                    </h3>
                    
                    <div class="settings-group">
                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">High Performance Mode</div>
                                <div class="setting-desc">Reduce effects for better performance</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('performanceMode')">
                                <div class="toggle-slider" id="performanceModeToggle"></div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <div class="setting-label">Battery Saver</div>
                                <div class="setting-desc">Minimal animations to save battery</div>
                            </div>
                            <div class="toggle-switch" onclick="toggleSetting('batterySaver')">
                                <div class="toggle-slider" id="batterySaverToggle"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--warning-orange); display: flex; align-items: center; gap: 8px;">
                        üöÄ Quick Actions
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <button class="btn-secondary" onclick="resetToDefaults()" style="font-size: 12px;">
                            üîÑ Reset All
                        </button>
                        <button class="btn-secondary" onclick="exportSettings()" style="font-size: 12px;">
                            üì§ Export Settings
                        </button>
                    </div>
                </div>

                <!-- App Info -->
                <div style="text-align: center; padding-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">
                        JomBro v2.0 - Cutting-Edge Interface
                    </div>
                    <div style="font-size: 10px; color: var(--text-secondary); opacity: 0.7;">
                        Layered Glass Architecture & AI Challenges
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Chat Interface -->
        <div id="chatInterface" class="chat-interface">
            <div style="padding: 15px 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div style="font-size: 16px; font-weight: 600; color: var(--text-primary);" id="chatTitle">Challenge Group Chat</div>
                    <div style="font-size: 12px; color: var(--text-secondary);" id="chatMembers">5 members online</div>
                </div>
                <button style="background: none; border: none; color: var(--text-secondary); font-size: 18px; cursor: pointer;" onclick="toggleChat()">‚úï</button>
            </div>
            <div style="flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px;" id="chatMessages">
                <!-- Messages appear here -->
            </div>
            <div style="padding: 15px; border-top: 1px solid rgba(255, 255, 255, 0.1); display: flex; gap: 10px; align-items: center;">
                <input type="text" style="flex: 1; background: rgba(255,255,255,0.1); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 10px 15px; color: var(--text-primary); font-size: 14px; outline: none; backdrop-filter: blur(15px);" id="chatInput" placeholder="Type a message..." onkeypress="handleChatKeyPress(event)">
                <button style="background: var(--primary-pink); border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; color: #fff; font-size: 16px;" onclick="sendMessage()">‚û§</button>
            </div>
        </div>

        <!-- Floating Chat Toggle -->
        <button id="chatToggle" class="chat-toggle" onclick="toggleChat()" style="display: none;">
            üí¨
        </button>
    </div>

    <script>
        // Background Management System
        let currentBackground = 'space';
        
        function switchBackground(type) {
            // Update active button in profile modal
            document.querySelectorAll('.background-option').forEach(option => option.classList.remove('active'));
            const activeOption = document.querySelector(`[data-bg="${type}"]`);
            if (activeOption) {
                activeOption.classList.add('active');
            }
            
            // Hide all backgrounds
            document.querySelectorAll('.background-content').forEach(bg => bg.classList.remove('active'));
            
            // Show selected background
            switch(type) {
                case 'space':
                    document.getElementById('spaceBackground').classList.add('active');
                    break;
                case 'planets':
                    document.getElementById('spacePlanetsBackground').classList.add('active');
                    break;
                case 'animated':
                    document.getElementById('animatedBackground').classList.add('active');
                    break;
                case 'video':
                    document.getElementById('videoBackground').classList.add('active');
                    break;
            }
            
            currentBackground = type;
            showToast(`‚ú® Background changed to ${type}!`, 'success');
        }
        
        function handleVideoUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('video/')) {
                const video = document.getElementById('customVideo');
                const url = URL.createObjectURL(file);
                video.src = url;
                
                // Switch to video background
                switchBackground('video');
                showToast('üìπ Custom video uploaded!', 'success');
            } else {
                showToast('‚ùå Please select a valid video file!', 'error');
            }
        }

        // Mock Authentication Functions
        window.signInWithGoogle = function() {
            showSuccess('Google sign-in successful!');
            setTimeout(() => {
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('chatToggle').style.display = 'block';
                document.getElementById('userDisplayName').textContent = 'Demo User';
                initializeApp();
            }, 1000);
        }

        window.signInWithFacebook = function() {
            showSuccess('Facebook sign-in successful!');
            setTimeout(() => {
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('chatToggle').style.display = 'block';
                document.getElementById('userDisplayName').textContent = 'Demo User';
                initializeApp();
            }, 1000);
        }

        window.signInAnonymously = function() {
            showSuccess('Test mode activated!');
            setTimeout(() => {
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('chatToggle').style.display = 'block';
                document.getElementById('userDisplayName').textContent = 'Test User';
                initializeApp();
            }, 1000);
        }

        window.showPhoneForm = function() {
            document.getElementById('mainAuth').style.display = 'none';
            document.getElementById('phoneForm').style.display = 'block';
        }

        window.showMainAuth = function() {
            document.getElementById('phoneForm').style.display = 'none';
            document.getElementById('mainAuth').style.display = 'block';
        }

        window.signInWithPhone = function() {
            showSuccess('Phone verification successful!');
            setTimeout(() => {
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('chatToggle').style.display = 'block';
                document.getElementById('userDisplayName').textContent = 'Phone User';
                initializeApp();
            }, 1000);
        }

        window.signOut = function() {
            document.getElementById('authScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('chatToggle').style.display = 'none';
            showSuccess('Signed out successfully!');
        }

        // App Initialization
        function initializeApp() {
            initializeChallenges();
            initializeOnlineUsers();
            updateLivePlayersDisplay();
        }

        // Challenge System
        const sampleChallenges = [
            {
                title: 'Coffee Shop Poetry Challenge',
                description: 'Visit any coffee shop and ask the barista to write a short poem on your cup or napkin!',
                difficulty: 'Easy',
                duration: '30m',
                tokens: 500,
                category: 'Social Connection',
                icon: 'üë•',
                color: '#ff6b9d'
            },
            {
                title: 'Sunrise Workout',
                description: 'Wake up early and do a 20-minute workout outside during sunrise. Capture the moment!',
                difficulty: 'Medium',
                duration: '45m',
                tokens: 600,
                category: 'Fitness & Health',
                icon: 'üí™',
                color: '#10b981'
            },
            {
                title: 'One-Minute Story Challenge',
                description: 'Record yourself telling a complete story in exactly 60 seconds. Make it engaging!',
                difficulty: 'Medium',
                duration: '30m',
                tokens: 550,
                category: 'Creative Expression',
                icon: 'üé®',
                color: '#8b5cf6'
            }
        ];

        function initializeChallenges() {
            displayChallengeSelection();
        }

        function displayChallengeSelection() {
            const container = document.getElementById('challengeSelection');
            container.innerHTML = sampleChallenges.map((challenge, index) => `
                <div class="challenge-card">
                    <div class="challenge-category-badge" style="background: ${challenge.color}; color: white;">
                        ${challenge.icon} ${challenge.category}
                    </div>
                    <div style="margin-top: 30px;">
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px; color: var(--primary-pink);">
                            ${challenge.title}
                        </div>
                        <div style="font-size: 13px; line-height: 1.4; margin-bottom: 15px; opacity: 0.9; color: var(--text-secondary);">
                            ${challenge.description}
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px;">
                            <div style="text-align: center; background: rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px; backdrop-filter: blur(15px);">
                                <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.tokens}</div>
                                <div style="font-size: 9px; color: var(--text-secondary);">TOKENS</div>
                            </div>
                            <div style="text-align: center; background: rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px; backdrop-filter: blur(15px);">
                                <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.difficulty}</div>
                                <div style="font-size: 9px; color: var(--text-secondary);">LEVEL</div>
                            </div>
                            <div style="text-align: center; background: rgba(255, 255, 255, 0.1); padding: 8px; border-radius: 8px; backdrop-filter: blur(15px);">
                                <div style="font-size: 14px; font-weight: 700; color: var(--primary-pink);">${challenge.duration}</div>
                                <div style="font-size: 9px; color: var(--text-secondary);">TIME</div>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="takeChallenge(${index})" style="width: 100%; padding: 12px; font-size: 13px;">
                            üöÄ TAKE CHALLENGE
                        </button>
                    </div>
                </div>
            `).join('');
        }

        window.refreshChallenges = function() {
            displayChallengeSelection();
            showToast('‚ú® New AI challenges generated!', 'success');
        }

        window.takeChallenge = function(index) {
            const challenge = sampleChallenges[index];
            if (confirm(`üéØ Ready to take on "${challenge.title}"?\n\nThis challenge will reward you with ${challenge.tokens} tokens!`)) {
                showToast(`üéØ Challenge "${challenge.title}" accepted!`, 'success');
            }
        }

        // Online Users System
        function initializeOnlineUsers() {
            const names = ['Alex Chen', 'Maya Patel', 'Jordan Kim', 'Sam Wilson', 'Rio Martinez'];
            updateLivePlayersDisplay();
        }

        function updateLivePlayersDisplay() {
            const container = document.getElementById('livePlayersContainer');
            const avatars = ['AC', 'MP', 'JK', 'SW', 'RM'];
            
            container.innerHTML = avatars.map(avatar => `
                <div class="player-avatar">
                    <div class="avatar-ring">
                        <div class="avatar-inner">${avatar}</div>
                    </div>
                    <div class="avatar-status"></div>
                </div>
            `).join('');
        }

        // Modal Functions
        window.showModal = function(id) {
            document.getElementById(id + 'Modal').classList.add('show');
        }

        window.hideModal = function(id) {
            document.getElementById(id + 'Modal').classList.remove('show');
        }

        window.showMyTasks = function() {
            showModal('myTasks');
        }

        window.showEnhancedProfile = function() {
            showModal('enhancedProfile');
        }

        window.showProfile = function() {
            showModal('enhancedProfile');
        }

        window.showGroups = function() {
            showToast('üè† Groups feature coming soon!', 'info');
        }

        window.showOnlineUsers = function() {
            showToast('üë• Online users feature coming soon!', 'info');
        }

        // Enhanced Profile Functions
        window.uploadProfilePicture = function() {
            document.getElementById('profileImageInput').click();
        }

        window.handleProfileImageUpload = function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profileImage').src = e.target.result;
                    document.getElementById('profileImage').style.display = 'block';
                    document.getElementById('profileInitials').style.display = 'none';
                    showToast('‚úÖ Profile picture updated!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }

        window.editProfileName = function() {
            const currentName = document.getElementById('enhancedProfileName').textContent;
            const newName = prompt('Update your name:', currentName);
            if (newName !== null && newName.trim()) {
                document.getElementById('enhancedProfileName').textContent = newName.trim();
                document.getElementById('userDisplayName').textContent = newName.trim();
                showToast('‚úÖ Name updated!', 'success');
            }
        }

        window.editProfileBio = function() {
            const currentBio = document.getElementById('enhancedProfileBio').textContent;
            const newBio = prompt('Update your bio:', currentBio);
            if (newBio !== null) {
                document.getElementById('enhancedProfileBio').textContent = newBio;
                showToast('‚úÖ Bio updated!', 'success');
            }
        }

        window.editEnhancedProfile = function() {
            editProfileBio();
        }

        window.shareProfile = function() {
            if (navigator.share) {
                navigator.share({
                    title: `Check out my JomBro Profile!`,
                    text: `Level 3 challenger with 1,250 tokens!`,
                    url: window.location.href
                });
            } else {
                showToast('üîó Profile shared to clipboard!', 'success');
                navigator.clipboard?.writeText(window.location.href);
            }
        }

        window.viewFullStats = function() {
            showToast('üìä Detailed stats coming soon!', 'info');
        }

        window.showSubmissionGallery = function() {
            showToast('üèÜ Gallery feature coming soon!', 'info');
        }

        window.showChallengeAgreement = function() {
            showModal('challengeAgreement');
        }

        window.agreeToChallenge = function() {
            hideModal('challengeAgreement');
            showToast('üéØ Great! Choose any challenge above!', 'success');
        }

        window.submitProof = function() {
            showToast('üì∏ Proof submission coming soon!', 'info');
        }

        window.viewChallenge = function() {
            showToast('üëÄ Challenge details coming soon!', 'info');
        }

        // Chat Functions
        window.toggleChat = function() {
            const chatInterface = document.getElementById('chatInterface');
            const chatToggle = document.getElementById('chatToggle');
            
            if (chatInterface.classList.contains('open')) {
                chatInterface.classList.remove('open');
                chatToggle.style.display = 'block';
            } else {
                chatInterface.classList.add('open');
                chatToggle.style.display = 'none';
                initializeChat();
            }
        }

        function initializeChat() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = `
                <div style="display: flex; justify-content: center; margin: 10px 0;">
                    <div style="background: rgba(255, 255, 255, 0.1); color: var(--text-secondary); font-size: 12px; text-align: center; max-width: 80%; padding: 8px 12px; border-radius: 12px;">
                        Welcome to the challenge group chat! Start discussing your challenges here.
                    </div>
                </div>
            `;
        }

        window.sendMessage = function() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.innerHTML = `
                <div style="display: flex; flex-direction: row-reverse; gap: 10px; margin-bottom: 10px;">
                    <div style="width: 32px; height: 32px; border-radius: 50%; background: var(--primary-pink); display: flex; align-items: center; justify-content: center; font-size: 12px; flex-shrink: 0;">YOU</div>
                    <div style="background: var(--primary-pink); padding: 8px 12px; border-radius: 12px; max-width: 70%; word-wrap: break-word;">
                        <div style="font-size: 14px; line-height: 1.4;">${text}</div>
                        <div style="font-size: 11px; color: rgba(255,255,255,0.8); margin-top: 4px;">now</div>
                    </div>
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            input.value = '';
        }

        window.handleChatKeyPress = function(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Settings Management System
        const appSettings = {
            livePlayersSection: true,
            challengeStatus: true,
            chatFeatures: true,
            notifications: true,
            glassBlur: true,
            backgroundAnimations: true,
            hoverEffects: true,
            particleEffects: true,
            performanceMode: false,
            batterySaver: false
        };

        window.showSettings = function() {
            showModal('settings');
            updateSettingsUI();
        }

        function updateSettingsUI() {
            Object.keys(appSettings).forEach(setting => {
                const toggle = document.getElementById(setting + 'Toggle');
                const switchElement = toggle?.parentElement;
                
                if (toggle) {
                    if (appSettings[setting]) {
                        toggle.classList.add('active');
                        switchElement?.classList.add('active');
                    } else {
                        toggle.classList.remove('active');
                        switchElement?.classList.remove('active');
                    }
                }
            });
        }

        window.toggleSetting = function(settingName) {
            appSettings[settingName] = !appSettings[settingName];
            updateSettingsUI();
            applySettings();
            
            const settingLabels = {
                livePlayersSection: 'Live Players',
                challengeStatus: 'Challenge Status',
                chatFeatures: 'Chat Features',
                notifications: 'Notifications',
                glassBlur: 'Glass Blur',
                backgroundAnimations: 'Background Animations',
                hoverEffects: 'Hover Effects',
                particleEffects: 'Particle Effects',
                performanceMode: 'Performance Mode',
                batterySaver: 'Battery Saver'
            };
            
            const status = appSettings[settingName] ? 'enabled' : 'disabled';
            showToast(`${settingLabels[settingName]} ${status}!`, 'success');
        }

        function applySettings() {
            const body = document.body;
            
            // Live Players Section
            const livePlayersSection = document.querySelector('.glass-section');
            if (livePlayersSection) {
                livePlayersSection.style.display = appSettings.livePlayersSection ? 'block' : 'none';
            }
            
            // Challenge Status
            const challengeStatus = document.getElementById('currentChallengeStatus');
            if (challengeStatus && !appSettings.challengeStatus) {
                challengeStatus.style.display = 'none';
            }
            
            // Chat Features
            const chatToggle = document.getElementById('chatToggle');
            const chatBtn = document.querySelector('[title="Group Chat"]');
            if (!appSettings.chatFeatures) {
                if (chatToggle) chatToggle.style.display = 'none';
                if (chatBtn) chatBtn.style.display = 'none';
            } else {
                if (chatToggle) chatToggle.style.display = 'block';
                if (chatBtn) chatBtn.style.display = 'flex';
            }
            
            // Notifications
            const badges = document.querySelectorAll('.notification-badge');
            badges.forEach(badge => {
                badge.style.display = appSettings.notifications ? 'flex' : 'none';
            });
            
            // Glass Blur Effect
            if (!appSettings.glassBlur) {
                body.classList.add('glass-reduced');
            } else {
                body.classList.remove('glass-reduced');
            }
            
            // Background Animations
            if (!appSettings.backgroundAnimations) {
                body.classList.add('animations-disabled');
            } else {
                body.classList.remove('animations-disabled');
            }
            
            // Hover Effects
            if (!appSettings.hoverEffects) {
                body.classList.add('hover-disabled');
            } else {
                body.classList.remove('hover-disabled');
            }
            
            // Particle Effects
            const shootingStars = document.querySelectorAll('.shooting-star');
            shootingStars.forEach(star => {
                star.style.display = appSettings.particleEffects ? 'block' : 'none';
            });
            
            // Performance Mode
            if (appSettings.performanceMode) {
                body.classList.add('performance-mode');
                // Auto-disable heavy features
                if (appSettings.backgroundAnimations) toggleSetting('backgroundAnimations');
                if (appSettings.particleEffects) toggleSetting('particleEffects');
            } else {
                body.classList.remove('performance-mode');
            }
            
            // Battery Saver
            if (appSettings.batterySaver) {
                body.classList.add('battery-saver');
                // Auto-disable all effects
                if (appSettings.backgroundAnimations) toggleSetting('backgroundAnimations');
                if (appSettings.particleEffects) toggleSetting('particleEffects');
                if (appSettings.hoverEffects) toggleSetting('hoverEffects');
                if (appSettings.glassBlur) toggleSetting('glassBlur');
            } else {
                body.classList.remove('battery-saver');
            }
            
            // Save settings to localStorage (if available)
            try {
                localStorage.setItem('jombroSettings', JSON.stringify(appSettings));
            } catch (e) {
                console.log('LocalStorage not available');
            }
        }

        window.resetToDefaults = function() {
            if (confirm('üîÑ Reset all settings to default? This cannot be undone.')) {
                Object.keys(appSettings).forEach(key => {
                    if (key === 'performanceMode' || key === 'batterySaver') {
                        appSettings[key] = false;
                    } else {
                        appSettings[key] = true;
                    }
                });
                
                updateSettingsUI();
                applySettings();
                showToast('üîÑ All settings reset to default!', 'success');
            }
        }

        window.exportSettings = function() {
            const settingsData = {
                settings: appSettings,
                timestamp: new Date().toISOString(),
                version: '2.0'
            };
            
            const dataStr = JSON.stringify(settingsData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'jombro-settings.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('üì§ Settings exported successfully!', 'success');
        }

        // Load settings on startup
        function loadSettings() {
            try {
                const saved = localStorage.getItem('jombroSettings');
                if (saved) {
                    const savedSettings = JSON.parse(saved);
                    Object.assign(appSettings, savedSettings);
                    applySettings();
                }
            } catch (e) {
                console.log('Error loading settings:', e);
            }
        }

        // Utility Functions
        function showError(message) {
            showToast(message, 'error');
        }

        function showSuccess(message) {
            showToast(message, 'success');
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.textContent = message;
            
            Object.assign(toast.style, {
                position: 'fixed',
                top: '20px',
                left: '50%',
                transform: 'translateX(-50%)',
                background: type === 'success' ? 'var(--success-green)' : 
                           type === 'error' ? 'var(--error-red)' : 'var(--primary-pink)',
                color: 'white',
                padding: '12px 20px',
                borderRadius: '10px',
                zIndex: '4000',
                fontSize: '14px',
                fontWeight: '600',
                opacity: '0',
                transition: 'all 0.3s ease',
                maxWidth: '90%',
                textAlign: 'center',
                backdropFilter: 'blur(20px)',
                border: '1px solid rgba(255, 255, 255, 0.1)',
                boxShadow: '0 8px 32px rgba(0, 0, 0, 0.3)'
            });
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '1';
                toast.style.transform = 'translateX(-50%) translateY(10px)';
            }, 100);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // Initialize the app when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ JomBro Cutting-Edge Layered Glass Interface Loaded!');
            console.log('‚ú® Features: Layered Glass Effect, Animated Backgrounds, Video Support');
            
            // Load saved settings
            loadSettings();
            
            // Initialize default UI state
            updateSettingsUI();
        });
    </script>
</body>
</html>
