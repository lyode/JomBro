<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- iPhone 15 Pro Max Specific Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="JomBro">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#000000">
    
    <!-- iPhone 15 Pro Max Display Settings -->
    <meta name="screen-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="browsermode" content="application">
    
    <title>JomBro - Social Challenge App</title>

    <style>
        /* iPhone 15 Pro Max Optimized Styles */
        :root {
            --iphone15-width: 430px;
            --iphone15-height: 932px;
            --dynamic-island-height: 37px;
            --safe-area-top: env(safe-area-inset-top, 47px);
            --safe-area-bottom: env(safe-area-inset-bottom, 34px);
            --safe-area-left: env(safe-area-inset-left, 0px);
            --safe-area-right: env(safe-area-inset-right, 0px);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html {
            height: 100vh;
            height: 100svh;
            overflow: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', sans-serif;
            background: radial-gradient(ellipse at center, #0f0f23 0%, #000000 70%);
            width: 100vw;
            height: 100vh;
            height: 100svh;
            color: #FFFFFF;
            overflow: hidden;
            position: fixed;
            top: 0;
            left: 0;
            font-weight: 300;
            transition: all 1s ease;
            font-size: 16px;
            line-height: 1.5;
        }

        /* iPhone 15 Pro Max Specific Adjustments */
        @media screen and (min-width: 428px) and (max-width: 432px) and (min-height: 926px) {
            body {
                width: 430px;
                height: 932px;
            }
        }

        /* Background Themes - Optimized for iPhone 15 Pro Max */
        body.underwater {
            background: radial-gradient(ellipse at center, #001a2e 0%, #003d5c 40%, #000814 100%);
        }

        body.sky {
            background: linear-gradient(to bottom, #87CEEB 0%, #98D8E8 50%, #B6E5F0 100%);
        }

        body.beach {
            background: linear-gradient(to bottom, #FFD700 0%, #F0E68C 30%, #87CEEB 70%, #4682B4 100%);
        }

        body.rainy {
            background: linear-gradient(to bottom, #2C3E50 0%, #34495E 50%, #1C2833 100%);
        }

        body.city {
            background: linear-gradient(to bottom, #2C3E50 0%, #34495E 30%, #1C1C1C 70%, #000000 100%);
        }

        body.jungle {
            background: linear-gradient(to bottom, #228B22 0%, #006400 30%, #004225 70%, #001a0d 100%);
        }

        body.forest {
            background: linear-gradient(to bottom, #2F4F2F 0%, #1C3A1C 50%, #0D1F0D 100%);
        }

        body.mountain {
            background: linear-gradient(to bottom, #4682B4 0%, #5F8A8B 30%, #2F4F4F 70%, #1C2833 100%);
        }

        body.desert {
            background: linear-gradient(to bottom, #F4A460 0%, #D2691E 50%, #8B4513 100%);
        }

        body.aurora {
            background: radial-gradient(ellipse at center, #001122 0%, #003366 40%, #000000 100%);
        }

        body.sunset {
            background: linear-gradient(to bottom, #FF6B47 0%, #FF8C42 30%, #F39C12 60%, #E67E22 100%);
        }

        body.snowy {
            background: linear-gradient(to bottom, #E8E8E8 0%, #D3D3D3 50%, #A9A9A9 100%);
        }

        body.cyberpunk {
            background: radial-gradient(ellipse at center, #1a0033 0%, #330066 40%, #000000 100%);
        }

        body.volcano {
            background: radial-gradient(ellipse at center, #660000 0%, #330000 50%, #000000 100%);
        }

        body.thunderstorm {
            background: linear-gradient(to bottom, #1C1C1C 0%, #2C2C54 30%, #40407A 60%, #000000 100%);
        }

        body.wedding {
            background: linear-gradient(to bottom, #FFE4E1 0%, #FFC0CB 30%, #F8F8FF 60%, #E6E6FA 100%);
        }

        body.tropical {
            background: linear-gradient(to bottom, #00CED1 0%, #48D1CC 30%, #20B2AA 60%, #008B8B 100%);
        }

        body.galaxy {
            background: radial-gradient(ellipse at center, #4B0082 0%, #8A2BE2 30%, #9932CC 60%, #000000 100%);
        }

        body.neon {
            background: radial-gradient(ellipse at center, #FF1493 0%, #00FFFF 30%, #FF69B4 60%, #000000 100%);
        }

        body.meadow {
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 30%, #90EE90 60%, #228B22 100%);
        }

        body.twilight {
            background: linear-gradient(to bottom, #191970 0%, #4B0082 30%, #8B008B 60%, #000000 100%);
        }

        body.carnival {
            background: linear-gradient(to bottom, #FF6347 0%, #FFD700 25%, #FF69B4 50%, #9370DB 75%, #FF4500 100%);
        }

        body.ice {
            background: linear-gradient(to bottom, #E0FFFF 0%, #B0E0E6 30%, #87CEEB 60%, #4682B4 100%);
        }

        body.steampunk {
            background: linear-gradient(to bottom, #8B4513 0%, #A0522D 30%, #D2691E 60%, #654321 100%);
        }

        body.retro {
            background: linear-gradient(to bottom, #FF6B9D 0%, #C44569 30%, #F8B500 60%, #6D214F 100%);
        }

        body.noir {
            background: linear-gradient(to bottom, #2C2C2C 0%, #1C1C1C 50%, #000000 100%);
        }

        body.paradise {
            background: linear-gradient(to bottom, #FFE066 0%, #FF6B6B 30%, #4ECDC4 60%, #45B7D1 100%);
        }

        body.mystic {
            background: radial-gradient(ellipse at center, #2E0249 0%, #570A57 30%, #A91079 60%, #000000 100%);
        }

        body.future {
            background: linear-gradient(to bottom, #00FFFF 0%, #0080FF 30%, #8000FF 60%, #FF0080 100%);
        }

        /* Dynamic Background Effects */
        .underwater-bubbles {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .bubble {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(135,206,250,0.1) 100%);
            border-radius: 50%;
            animation: bubbleFloat 8s linear infinite;
            box-shadow: 0 0 10px rgba(255,255,255,0.2);
        }

        .sky-clouds {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .cloud {
            position: absolute;
            width: 100px;
            height: 40px;
            background: rgba(255,255,255,0.6);
            border-radius: 40px;
            animation: cloudDrift 30s linear infinite;
            filter: blur(1px);
        }

        .beach-waves {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: repeating-linear-gradient(
                90deg,
                rgba(255,255,255,0.1) 0px,
                rgba(135,206,250,0.2) 50px,
                rgba(255,255,255,0.1) 100px
            );
            animation: waveMotion 4s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        .rain-drops {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .rain-drop {
            position: absolute;
            width: 2px;
            height: 20px;
            background: linear-gradient(to bottom, transparent, rgba(135,206,250,0.6), transparent);
            animation: rainFall 1.5s linear infinite;
        }

        .city-lights {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: 
                radial-gradient(2px 2px at 20px 40px, #FFD700, transparent),
                radial-gradient(3px 3px at 80px 20px, #FF6B47, transparent),
                radial-gradient(2px 2px at 150px 60px, #4FC3F7, transparent),
                radial-gradient(1px 1px at 200px 30px, #FF3366, transparent);
            background-repeat: repeat-x;
            background-size: 250px 100px;
            animation: cityTwinkle 3s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        .jungle-leaves {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .leaf {
            position: absolute;
            width: 15px;
            height: 25px;
            background: rgba(34,139,34,0.7);
            border-radius: 0 100% 0 100%;
            animation: leafFall 12s linear infinite;
        }

        .aurora-lights {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 30% 20%, rgba(0,255,150,0.2) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 40%, rgba(138,43,226,0.2) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 60%, rgba(64,93,230,0.2) 0%, transparent 50%);
            animation: auroraWave 15s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        .snow-flakes {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .snowflake {
            position: absolute;
            color: rgba(255,255,255,0.8);
            font-size: 1em;
            animation: snowFall 10s linear infinite;
        }

        .cyberpunk-grid {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(255,0,150,0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,255,255,0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridPulse 4s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        .thunderstorm-effects {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .lightning {
            position: absolute;
            width: 2px;
            height: 100vh;
            background: linear-gradient(to bottom, transparent, rgba(255,255,255,0.9), transparent);
            animation: lightningFlash 0.1s ease-in-out;
            opacity: 0;
        }

        .wedding-petals {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .petal {
            position: absolute;
            width: 8px;
            height: 12px;
            background: rgba(255,192,203,0.8);
            border-radius: 50% 10% 50% 10%;
            animation: petalFall 8s linear infinite;
        }

        .tropical-fish {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .fish {
            position: absolute;
            width: 30px;
            height: 15px;
            background: rgba(255,165,0,0.7);
            border-radius: 50% 0 50% 0;
            animation: fishSwim 15s linear infinite;
        }

        .galaxy-spiral {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(138,43,226,0.3) 0%, transparent 70%);
            border-radius: 50%;
            animation: galaxyRotate 30s linear infinite;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 1;
        }

        .neon-lines {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, rgba(255,20,147,0.2) 1px, transparent 1px),
                linear-gradient(0deg, rgba(0,255,255,0.2) 1px, transparent 1px);
            background-size: 40px 40px;
            animation: neonPulse 3s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        .fireflies {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .firefly {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255,255,0,0.8);
            border-radius: 50%;
            animation: firefly 8s ease-in-out infinite;
            box-shadow: 0 0 10px rgba(255,255,0,0.6);
        }

        /* Starfield Background */
        .starfield {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
                radial-gradient(2px 2px at 160px 30px, #ddd, transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: starTwinkle 8s linear infinite, starDrift 60s linear infinite;
            z-index: 0;
        }

        .starfield::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(1px 1px at 25px 45px, rgba(135, 206, 250, 0.8), transparent),
                radial-gradient(1px 1px at 65px 15px, rgba(255, 182, 193, 0.6), transparent),
                radial-gradient(2px 2px at 110px 55px, rgba(255, 255, 255, 0.9), transparent),
                radial-gradient(1px 1px at 170px 25px, rgba(173, 216, 230, 0.7), transparent);
            background-repeat: repeat;
            background-size: 250px 150px;
            animation: starTwinkle 12s linear infinite reverse, starDrift 80s linear infinite reverse;
        }

        .blinking-stars {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .blinking-star {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #fff;
            border-radius: 50%;
            animation: starBlink 4s ease-in-out infinite;
            box-shadow: 0 0 6px rgba(255, 255, 255, 0.8);
        }

        .blinking-star.blue {
            background: #4FC3F7;
            box-shadow: 0 0 8px rgba(79, 195, 247, 0.8);
            animation-duration: 6s;
        }

        .blinking-star.yellow {
            background: #FFD54F;
            box-shadow: 0 0 8px rgba(255, 213, 79, 0.8);
            animation-duration: 5s;
        }

        .blinking-star.pink {
            background: #F8BBD9;
            box-shadow: 0 0 8px rgba(248, 187, 217, 0.8);
            animation-duration: 7s;
        }

        .rotating-stars {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            animation: slowRotate 200s linear infinite;
        }

        .rotating-star {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            animation: starPulse 8s ease-in-out infinite;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.6);
        }

        .passing-planets {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .planet {
            position: absolute;
            border-radius: 50%;
            animation: planetPass 30s linear infinite;
            opacity: 0.7;
            filter: blur(1px);
        }

        .planet.mars {
            width: 20px;
            height: 20px;
            background: radial-gradient(circle at 30% 30%, #ff6b47, #d32f2f);
            box-shadow: 0 0 20px rgba(255, 107, 71, 0.4);
            animation-duration: 45s;
        }

        .planet.jupiter {
            width: 35px;
            height: 35px;
            background: radial-gradient(circle at 30% 30%, #ffa726, #f57f17);
            box-shadow: 0 0 30px rgba(255, 167, 38, 0.3);
            animation-duration: 60s;
            animation-delay: -20s;
        }

        .planet.saturn {
            width: 25px;
            height: 25px;
            background: radial-gradient(circle at 30% 30%, #fff176, #f9a825);
            box-shadow: 0 0 25px rgba(255, 241, 118, 0.4);
            animation-duration: 50s;
            animation-delay: -35s;
        }

        /* Dark Overlay */
        .dark-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(0.2px);
            -webkit-backdrop-filter: blur(0.2px);
            z-index: 2;
        }

        /* iPhone 15 Pro Max Main Container */
        .main-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10;
            display: flex;
            flex-direction: column;
            width: 100vw;
            height: 100vh;
            height: 100svh;
        }

        /* iPhone 15 Pro Max Header - Optimized for Dynamic Island */
        .dark-header {
            position: fixed;
            top: var(--safe-area-top);
            left: var(--safe-area-left, 20px);
            right: var(--safe-area-right, 20px);
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.02);
            border-radius: 28px;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
            height: 68px;
            margin-top: 16px;
            margin-left: 20px;
            margin-right: 20px;
            width: calc(100vw - 40px);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.02),
                0 0 40px rgba(0, 255, 150, 0.03);
            animation: headerFloat 12s ease-in-out infinite;
            transform-style: preserve-3d;
        }

        .dark-logo {
            font-size: 28px;
            font-weight: 300;
            color: #FFFFFF;
            text-shadow: 
                0 0 20px rgba(255, 255, 255, 0.4),
                2px 2px 6px rgba(0, 0, 0, 0.9);
            animation: logoFloat 8s ease-in-out infinite;
        }

        .dark-header-icons {
            display: flex;
            align-items: center;
            gap: 18px;
        }

        /* iPhone 15 Pro Max Optimized Buttons */
        .round-btn {
            width: 44px;
            height: 44px;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 2px solid rgba(64, 93, 230, 0.8);
            border-radius: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
            transition: all 1.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            color: #FFFFFF;
            text-shadow: 
                0 0 12px rgba(255, 255, 255, 0.5),
                2px 2px 4px rgba(0, 0, 0, 0.9);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                0 0 15px rgba(255, 255, 255, 0.2),
                0 4px 8px rgba(255, 255, 255, 0.1);
            position: relative;
            transform-style: preserve-3d;
            animation: slowButtonFloat 25s ease-in-out infinite;
        }

        .round-btn:hover {
            transform: translateY(-8px) translateZ(15px) scale(1.08);
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(64, 93, 230, 1);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.2),
                0 0 30px rgba(64, 93, 230, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.4),
                0 0 25px rgba(255, 255, 255, 0.3);
            transition: all 1.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .round-btn:active {
            transform: translateY(-30px) translateZ(60px) scale(1.2);
            animation: smooth18Float 1.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            filter: brightness(1.3) saturate(1.2);
            transition: all 1.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #FF3366, #FF6B35);
            border-radius: 10px;
            font-size: 11px;
            color: white;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 0 15px rgba(255, 51, 102, 0.6),
                0 4px 8px rgba(0, 0, 0, 0.3);
            animation: badgeFloat 4s ease infinite;
        }

        /* iPhone 15 Pro Max Stories Section */
        .dark-stories {
            position: fixed;
            top: calc(var(--safe-area-top) + 100px);
            left: var(--safe-area-left, 20px);
            right: var(--safe-area-right, 20px);
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.02);
            border-radius: 24px;
            padding: 20px;
            z-index: 900;
            height: 120px;
            margin-left: 20px;
            margin-right: 20px;
            width: calc(100vw - 40px);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.02);
            animation: storiesFloat 15s ease-in-out infinite;
            transform-style: preserve-3d;
        }

        .stories-scroll {
            display: flex;
            gap: 18px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            padding: 6px 0;
        }

        .stories-scroll::-webkit-scrollbar { 
            display: none; 
        }

        .story-item {
            min-width: 80px;
            text-align: center;
        }

        .story-circle {
            width: 80px;
            height: 80px;
            border-radius: 40px;
            background: linear-gradient(45deg, 
                rgba(0, 255, 150, 0.5), 
                rgba(64, 93, 230, 0.5), 
                rgba(138, 43, 226, 0.5), 
                rgba(255, 255, 255, 0.3));
            padding: 3px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(0, 255, 150, 0.2);
            animation: slowStoryFloat 30s ease-in-out infinite;
            transform-style: preserve-3d;
            position: relative;
        }

        .story-circle:hover {
            transform: translateY(-8px) translateZ(20px) scale(1.08);
            transition: all 4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .story-circle:active {
            transform: translateY(-25px) translateZ(50px) scale(1.2);
            animation: ultraSlowFloat 5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            transition: all 5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .story-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px solid rgba(0, 0, 0, 0.1);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.05);
        }

        .story-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            filter: brightness(1.1) contrast(1.1);
        }

        .story-name {
            font-size: 13px;
            font-weight: 400;
            color: #FFFFFF;
            text-shadow: 
                0 0 8px rgba(255, 255, 255, 0.3),
                1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        /* iPhone 15 Pro Max Feed Section */
        .dark-feed {
            position: fixed;
            top: calc(var(--safe-area-top) + 240px);
            left: 0;
            right: 0;
            bottom: calc(var(--safe-area-bottom) + 100px);
            overflow: hidden;
            z-index: 100;
            padding: 0 20px;
            perspective: 1000px;
        }

        .feed-pages {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        .challenge-card {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            width: calc(100% - 40px);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.02);
            border-radius: 28px;
            overflow: hidden;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.02),
                0 0 60px rgba(0, 255, 150, 0.03);
            animation: cardFloatUp 18s ease-in-out infinite;
            transform-style: preserve-3d;
            transform-origin: bottom center;
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .challenge-card.current {
            transform: translateZ(0px) rotateX(0deg);
            z-index: 10;
        }

        .challenge-card.next {
            transform: translateZ(-100px) rotateX(-90deg);
            z-index: 5;
        }

        .challenge-card.prev {
            transform: translateZ(-100px) rotateX(90deg);
            z-index: 5;
        }

        /* iPhone 15 Pro Max Side Actions */
        .side-actions {
            position: absolute;
            right: 24px;
            bottom: 180px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            z-index: 200;
        }

        .action-btn {
            width: 56px;
            height: 56px;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(0, 191, 255, 0.8);
            border-radius: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            color: #FFFFFF;
            text-shadow: 
                0 0 12px rgba(255, 255, 255, 0.4),
                1px 1px 2px rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 10px 20px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                0 0 20px rgba(255, 255, 255, 0.2),
                0 6px 12px rgba(255, 255, 255, 0.1);
            animation: slowActionFloat 28s ease-in-out infinite;
            transform-style: preserve-3d;
            position: relative;
        }

        .action-btn:hover {
            transform: translateY(-20px) translateZ(40px) scale(1.15);
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(0, 191, 255, 1);
            box-shadow: 
                0 30px 60px rgba(0, 0, 0, 0.2),
                0 0 50px rgba(0, 191, 255, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.4),
                0 0 40px rgba(255, 255, 255, 0.3);
            transition: all 4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .action-btn:active {
            transform: translateY(-50px) translateZ(100px) scale(1.4);
            animation: ultraSlowFloat 5.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            filter: brightness(1.5) saturate(1.3);
            transition: all 5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .points-btn {
            flex-direction: column;
            background: rgba(0, 0, 0, 0.02);
            border-color: rgba(0, 255, 150, 0.4);
            height: 72px;
            padding: 10px;
            box-shadow: 
                0 10px 20px rgba(0, 0, 0, 0.1),
                0 0 25px rgba(0, 255, 150, 0.2);
        }

        .points-number {
            font-size: 16px;
            font-weight: 700;
            line-height: 1;
            color: #FFFFFF;
            text-shadow: 
                0 0 15px rgba(0, 255, 150, 0.6),
                1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .points-label {
            font-size: 10px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.8);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        /* iPhone 15 Pro Max Challenge Content */
        .challenge-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 36px;
            z-index: 150;
        }

        .challenge-user {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 18px;
        }

        .challenge-avatar {
            width: 48px;
            height: 48px;
            border-radius: 24px;
            background: linear-gradient(45deg, 
                rgba(0, 255, 150, 0.6), 
                rgba(64, 93, 230, 0.6), 
                rgba(138, 43, 226, 0.6), 
                rgba(255, 255, 255, 0.4));
            padding: 3px;
            box-shadow: 
                0 6px 12px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(0, 255, 150, 0.2);
            animation: avatarFloat 10s ease infinite;
        }

        .challenge-avatar-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 2px solid rgba(0, 0, 0, 0.1);
        }

        .challenge-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            filter: brightness(1.2) contrast(1.1);
        }

        .challenge-username {
            color: #FFFFFF;
            font-weight: 400;
            font-size: 18px;
            text-shadow: 
                0 0 15px rgba(255, 255, 255, 0.5),
                2px 2px 6px rgba(0, 0, 0, 0.9);
        }

        .challenge-text {
            font-size: 20px;
            font-weight: 300;
            color: #FFFFFF;
            text-shadow: 
                0 0 18px rgba(255, 255, 255, 0.5),
                2px 2px 8px rgba(0, 0, 0, 0.9);
            margin-bottom: 18px;
            line-height: 1.4;
        }

        .challenge-hashtags {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 24px;
        }

        .challenge-hashtag {
            color: #4FC3F7;
            font-size: 15px;
            font-weight: 400;
            text-shadow: 
                0 0 8px rgba(79, 195, 247, 0.5),
                1px 1px 2px rgba(0, 0, 0, 0.8);
            padding: 8px 14px;
            background: rgba(200, 200, 200, 0.15);
            border: 1px solid rgba(79, 195, 247, 0.3);
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            transform: scale(1);
        }

        .challenge-hashtag::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .challenge-hashtag::after {
            content: '';
            position: absolute;
            top: 1px;
            left: 1px;
            width: 4px;
            height: 4px;
            background: #FFD54F;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .challenge-hashtag:hover {
            transform: scale(1);
            background: rgba(200, 200, 200, 0.25);
            color: #4FC3F7;
            border-color: rgba(79, 195, 247, 0.5);
        }

        .challenge-hashtag:hover::before {
            opacity: 1;
        }

        .challenge-hashtag:hover::after {
            opacity: 1;
        }

        .challenge-reward {
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(0, 255, 150, 0.4);
            color: #FFFFFF;
            padding: 12px 20px;
            border-radius: 22px;
            font-size: 16px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 28px;
            text-shadow: 
                0 0 12px rgba(0, 255, 150, 0.6),
                1px 1px 2px rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 6px 12px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(0, 255, 150, 0.2);
            animation: rewardFloat 6s ease infinite;
        }

        /* iPhone 15 Pro Max Challenge Buttons */
        .challenge-actions {
            display: flex;
            gap: 16px;
        }

        .challenge-btn {
            flex: 1;
            padding: 18px 24px;
            border: none;
            border-radius: 24px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 3.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);
        }

        .challenge-btn:hover {
            transform: translateY(-12px) translateZ(25px) scale(1.05);
            transition: all 4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .challenge-btn:active {
            transform: translateY(-30px) translateZ(60px) scale(1.2);
            animation: ultraSlowFloat 4.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            filter: brightness(1.4);
            transition: all 4.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .btn-accept {
            background: rgba(0, 0, 0, 0.02);
            border: 1px solid rgba(0, 255, 150, 0.4);
            color: #FFFFFF;
            text-shadow: 
                0 0 12px rgba(0, 255, 150, 0.6),
                1px 1px 2px rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(0, 255, 150, 0.15);
        }

        .btn-accept:hover {
            transform: translateY(-12px) translateZ(25px) scale(1.05);
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(0, 255, 150, 0.6);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 0 40px rgba(0, 255, 150, 0.25);
        }

        .btn-decline {
            background: rgba(0, 0, 0, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.05),
                0 0 15px rgba(255, 255, 255, 0.02);
        }

        .btn-decline:hover {
            transform: translateY(-12px) translateZ(25px) scale(1.05);
            background: rgba(0, 0, 0, 0.05);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 0 25px rgba(255, 255, 255, 0.05);
        }

        /* iPhone 15 Pro Max Bottom Navigation */
        .dark-nav {
            position: fixed;
            bottom: var(--safe-area-bottom);
            left: var(--safe-area-left, 20px);
            right: var(--safe-area-right, 20px);
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.02);
            border-radius: 28px 28px 0 0;
            display: flex;
            justify-content: space-around;
            padding: 20px var(--safe-area-left, 0) calc(20px + var(--safe-area-bottom, 0)) var(--safe-area-right, 0);
            z-index: 1000;
            margin-left: 20px;
            margin-right: 20px;
            width: calc(100vw - 40px);
            box-shadow: 
                0 -8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.02);
            animation: navFloat 16s ease-in-out infinite;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 3.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            padding: 12px 16px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.01);
            backdrop-filter: blur(10px);
            transform-style: preserve-3d;
            animation: slowNavFloat 35s ease-in-out infinite;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .nav-item:active {
            transform: translateY(-25px) translateZ(50px) scale(1.3);
            animation: ultraSlowNavPopUp 6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            filter: brightness(1.3);
            transition: all 5.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 6px;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }

        .nav-item.active {
            color: #FFFFFF;
            text-shadow: 
                0 0 15px rgba(0, 255, 150, 0.6),
                1px 1px 2px rgba(0, 0, 0, 0.8);
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 255, 150, 0.3);
            box-shadow: 
                0 6px 12px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(0, 255, 150, 0.2);
            transform: translateZ(8px);
        }

        .nav-item.active .nav-icon {
            transform: scale(1.15) translateZ(5px);
            text-shadow: 
                0 0 12px rgba(0, 255, 150, 0.8),
                0 0 8px rgba(255, 255, 255, 0.3);
        }

        /* Modal System for iPhone 15 Pro Max */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 24px;
        }

        .modal.show {
            display: flex;
            animation: modalFadeIn 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .modal-content {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 28px;
            padding: 36px;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: modalContentFloat 10s ease-in-out infinite;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 28px;
            text-align: center;
            color: #FFFFFF;
            text-shadow: 
                0 0 20px rgba(0, 255, 150, 0.6),
                2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .form-control {
            width: 100%;
            padding: 16px 20px;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            color: #FFFFFF;
            font-size: 16px;
            font-weight: 400;
            outline: none;
            transition: all 0.4s ease;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);
        }

        .form-control:focus {
            border-color: rgba(0, 255, 150, 0.5);
            background: rgba(0, 0, 0, 0.05);
            box-shadow: 0 0 25px rgba(0, 255, 150, 0.2);
        }

        .btn-primary {
            width: 100%;
            padding: 18px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 150, 0.4);
            border-radius: 18px;
            color: #FFFFFF;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.8s ease;
            margin-bottom: 14px;
            text-shadow: 
                0 0 12px rgba(0, 255, 150, 0.6),
                1px 1px 2px rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(0, 255, 150, 0.15);
        }

        .btn-primary:hover {
            transform: translateY(-6px) scale(1.05);
            background: rgba(0, 0, 0, 0.9);
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.4),
                0 0 35px rgba(0, 255, 150, 0.25);
        }

        .btn-primary:active {
            transform: translateY(-15px) scale(1.1);
            animation: superFloat 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        .btn-secondary {
            width: 100%;
            padding: 18px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 18px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.6s ease;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .btn-secondary:hover {
            transform: translateY(-6px) scale(1.05);
            background: rgba(0, 0, 0, 0.7);
        }

        .btn-secondary:active {
            transform: translateY(-12px) scale(1.08);
        }

        /* iPhone 15 Pro Max Toast */
        .toast {
            position: fixed;
            top: calc(var(--safe-area-top) + 160px);
            left: 24px;
            right: 24px;
            background: rgba(0, 0, 0, 0.02);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(0, 255, 150, 0.3);
            color: #FFFFFF;
            padding: 16px 20px;
            border-radius: 18px;
            font-size: 16px;
            font-weight: 500;
            text-align: center;
            z-index: 3000;
            transform: translateY(-100px);
            opacity: 0;
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            text-shadow: 
                0 0 10px rgba(0, 255, 150, 0.6),
                1px 1px 2px rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(0, 255, 150, 0.2);
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Background Settings Modal for iPhone 15 Pro Max */
        .background-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 18px;
            margin-bottom: 28px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .bg-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 18px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.5s ease;
            text-align: center;
        }

        .bg-option:hover {
            transform: translateY(-4px) scale(1.05);
            border-color: rgba(0, 255, 150, 0.5);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        .bg-option.active {
            border-color: rgba(0, 255, 150, 0.8);
            background: rgba(0, 255, 150, 0.1);
            box-shadow: 0 0 20px rgba(0, 255, 150, 0.3);
        }

        .bg-preview {
            font-size: 36px;
            margin-bottom: 10px;
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.3));
        }

        .bg-name {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        /* Animation Keyframes */
        @keyframes starTwinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes starDrift {
            0% { transform: translateX(0px); }
            100% { transform: translateX(-200px); }
        }

        @keyframes starBlink {
            0%, 100% { 
                opacity: 0.8; 
                transform: scale(1);
            }
            50% { 
                opacity: 0.2; 
                transform: scale(1.2);
            }
        }

        @keyframes slowRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes starPulse {
            0%, 100% { 
                opacity: 0.7; 
                transform: scale(1);
            }
            50% { 
                opacity: 1; 
                transform: scale(1.3);
            }
        }

        @keyframes planetPass {
            0% {
                transform: translateX(-100px) translateY(100vh);
                opacity: 0;
            }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% {
                transform: translateX(100vw) translateY(-100px);
                opacity: 0;
            }
        }

        @keyframes bubbleFloat {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% {
                transform: translateY(-100px) scale(1.2);
                opacity: 0;
            }
        }

        @keyframes cloudDrift {
            0% { transform: translateX(-200px); }
            100% { transform: translateX(100vw); }
        }

        @keyframes waveMotion {
            0%, 100% { transform: translateX(0px); }
            50% { transform: translateX(-50px); }
        }

        @keyframes rainFall {
            0% { transform: translateY(-100px) rotate(10deg); }
            100% { transform: translateY(100vh) rotate(10deg); }
        }

        @keyframes cityTwinkle {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0.4; }
        }

        @keyframes leafFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes auroraWave {
            0%, 100% { 
                opacity: 0.3;
                transform: translateY(0px) scale(1);
            }
            50% { 
                opacity: 0.7;
                transform: translateY(-20px) scale(1.1);
            }
        }

        @keyframes snowFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes lightningFlash {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        @keyframes petalFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes fishSwim {
            0% {
                transform: translateX(-50px) translateY(50vh);
            }
            50% {
                transform: translateX(50vw) translateY(30vh);
            }
            100% {
                transform: translateX(110vw) translateY(70vh);
            }
        }

        @keyframes galaxyRotate {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        @keyframes neonPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }

        @keyframes firefly {
            0%, 100% { 
                opacity: 0.3;
                transform: translateY(0px) translateX(0px);
            }
            25% { 
                opacity: 1;
                transform: translateY(-20px) translateX(10px);
            }
            50% { 
                opacity: 0.5;
                transform: translateY(-10px) translateX(-15px);
            }
            75% { 
                opacity: 1;
                transform: translateY(-25px) translateX(20px);
            }
        }

        @keyframes gridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }

        @keyframes smooth18Float {
            0% { 
                transform: translateY(-30px) translateZ(60px) scale(1.2);
                opacity: 1;
            }
            30% { 
                transform: translateY(-45px) translateZ(90px) scale(1.35);
                opacity: 0.95;
                filter: brightness(1.5) saturate(1.3);
            }
            70% { 
                transform: translateY(-25px) translateZ(50px) scale(1.15);
                opacity: 0.9;
                filter: brightness(1.2) saturate(1.1);
            }
            95% { 
                transform: translateY(-5px) translateZ(5px) scale(1.02);
                opacity: 0.98;
                filter: brightness(1.05) saturate(1.02);
            }
            100% { 
                transform: translateY(0px) translateZ(0px) scale(1);
                opacity: 1;
                filter: brightness(1) saturate(1);
            }
        }

        @keyframes ultraSlowFloat {
            0% { 
                transform: translateY(-25px) translateZ(50px) scale(1.2);
                opacity: 1;
            }
            30% { 
                transform: translateY(-40px) translateZ(80px) scale(1.4);
                opacity: 0.95;
                filter: brightness(1.4) saturate(1.25);
            }
            70% { 
                transform: translateY(-20px) translateZ(40px) scale(1.1);
                opacity: 0.92;
                filter: brightness(1.15) saturate(1.08);
            }
            95% { 
                transform: translateY(-3px) translateZ(3px) scale(1.01);
                opacity: 0.98;
                filter: brightness(1.03) saturate(1.01);
            }
            100% { 
                transform: translateY(0px) translateZ(0px) scale(1);
                opacity: 1;
                filter: brightness(1) saturate(1);
            }
        }

        @keyframes ultraSlowNavPopUp {
            0% { 
                transform: translateY(-25px) translateZ(50px) scale(1.3);
                opacity: 1;
            }
            25% { 
                transform: translateY(-35px) translateZ(70px) scale(1.45);
                opacity: 0.96;
                filter: brightness(1.35) saturate(1.2);
            }
            60% { 
                transform: translateY(-18px) translateZ(35px) scale(1.15);
                opacity: 0.93;
                filter: brightness(1.12) saturate(1.05);
            }
            90% { 
                transform: translateY(-4px) translateZ(4px) scale(1.03);
                opacity: 0.98;
                filter: brightness(1.04) saturate(1.01);
            }
            100% { 
                transform: translateY(0px) translateZ(0px) scale(1);
                opacity: 1;
                filter: brightness(1) saturate(1);
            }
        }

        @keyframes slowButtonFloat {
            0%, 100% { 
                transform: translateY(0px) translateZ(0px) scale(1);
                opacity: 1;
            }
            25% { 
                transform: translateY(-3px) translateZ(3px) scale(1.02);
                opacity: 0.95;
            }
            50% { 
                transform: translateY(-6px) translateZ(6px) scale(1.04);
                opacity: 0.9;
            }
            75% { 
                transform: translateY(-3px) translateZ(3px) scale(1.02);
                opacity: 0.95;
            }
        }

        @keyframes slowActionFloat {
            0%, 100% { 
                transform: translateY(0px) translateZ(0px) scale(1);
                opacity: 1;
            }
            33% { 
                transform: translateY(-4px) translateZ(4px) scale(1.03);
                opacity: 0.93;
            }
            66% { 
                transform: translateY(-8px) translateZ(8px) scale(1.05);
                opacity: 0.87;
            }
        }

        @keyframes slowStoryFloat {
            0%, 100% { 
                transform: translateY(0px) translateZ(0px) scale(1);
                opacity: 1;
            }
            30% { 
                transform: translateY(-2px) translateZ(2px) scale(1.01);
                opacity: 0.96;
            }
            60% { 
                transform: translateY(-4px) translateZ(4px) scale(1.03);
                opacity: 0.92;
            }
            90% { 
                transform: translateY(-2px) translateZ(2px) scale(1.01);
                opacity: 0.96;
            }
        }

        @keyframes slowNavFloat {
            0%, 100% { 
                transform: translateY(0px) translateZ(0px);
                opacity: 1;
            }
            25% { 
                transform: translateY(-2px) translateZ(2px);
                opacity: 0.97;
            }
            50% { 
                transform: translateY(-4px) translateZ(4px);
                opacity: 0.94;
            }
            75% { 
                transform: translateY(-2px) translateZ(2px);
                opacity: 0.97;
            }
        }

        @keyframes headerFloat {
            0%, 100% { transform: translateY(0px) translateZ(0px); }
            50% { transform: translateY(-5px) translateZ(8px); }
        }

        @keyframes storiesFloat {
            0%, 100% { transform: translateY(0px) translateZ(0px); }
            50% { transform: translateY(-4px) translateZ(6px); }
        }

        @keyframes navFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-4px); }
        }

        @keyframes logoFloat {
            0%, 100% { transform: scale(1) translateY(0px); }
            50% { transform: scale(1.03) translateY(-2px); }
        }

        @keyframes avatarFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }

        @keyframes rewardFloat {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-4px) scale(1.03); }
        }

        @keyframes cardFloatUp {
            0%, 100% { transform: translateY(0px) translateZ(0px); }
            50% { transform: translateY(-10px) translateZ(10px); }
        }

        @keyframes badgeFloat {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes modalContentFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        @keyframes moneyFloat {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            50% { transform: translateY(-40px) scale(1.2); opacity: 0.9; }
            100% { transform: translateY(-80px) scale(0.8); opacity: 0; }
        }

        @keyframes businessFloat {
            0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 1; }
            50% { transform: translateY(-50px) scale(1.3) rotate(180deg); opacity: 0.9; }
            100% { transform: translateY(-100px) scale(0.7) rotate(360deg); opacity: 0; }
        }

        @keyframes superFloat {
            0% { transform: translateY(-15px) scale(1.1); }
            50% { transform: translateY(-25px) scale(1.15); filter: brightness(1.3); }
            100% { transform: translateY(0px) scale(1); filter: brightness(1); }
        }

        @keyframes heartFloat {
            0% { transform: translateX(-50%) translateY(0) scale(1); opacity: 1; }
            50% { transform: translateX(-50%) translateY(-20px) scale(1.2); opacity: 0.8; }
            100% { transform: translateX(-50%) translateY(-40px) scale(0.8); opacity: 0; }
        }

        /* iPhone 15 Pro Max Specific Responsive Adjustments */
        @media screen and (max-width: 432px) {
            .dark-header {
                height: 64px;
                padding: 14px 20px;
            }
            
            .dark-logo {
                font-size: 26px;
            }
            
            .round-btn {
                width: 42px;
                height: 42px;
                font-size: 17px;
            }
            
            .dark-stories {
                height: 115px;
                padding: 18px;
            }
            
            .story-circle {
                width: 76px;
                height: 76px;
            }
            
            .side-actions {
                right: 20px;
                bottom: 160px;
                gap: 20px;
            }
            
            .action-btn {
                width: 52px;
                height: 52px;
                font-size: 22px;
            }
            
            .points-btn {
                height: 68px;
            }
            
            .challenge-content {
                padding: 32px;
            }
            
            .challenge-text {
                font-size: 19px;
            }
            
            .challenge-btn {
                padding: 16px 20px;
                font-size: 16px;
            }
        }

        /* Landscape Mode Adjustments for iPhone 15 Pro Max */
        @media screen and (orientation: landscape) and (max-height: 450px) {
            .dark-stories {
                height: 95px;
                padding: 14px 18px;
            }
            
            .story-circle {
                width: 70px;
                height: 70px;
            }
            
            .dark-feed {
                top: calc(var(--safe-area-top) + 200px);
            }
            
            .side-actions {
                bottom: 120px;
                gap: 16px;
            }
            
            .action-btn {
                width: 48px;
                height: 48px;
                font-size: 20px;
            }
        }

        /* High Contrast Mode Support */
        @media (prefers-contrast: high) {
            .round-btn, .action-btn, .challenge-btn {
                border: 3px solid rgba(255, 255, 255, 0.8);
            }
            
            .challenge-hashtag {
                border: 2px solid rgba(79, 195, 247, 0.8);
            }
            
            .nav-item.active {
                border: 2px solid rgba(0, 255, 150, 0.8);
            }
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Outer Space Starfield Background -->
    <div class="starfield"></div>

    <!-- Dynamic Background Effects -->
    <div id="backgroundEffects">
        <div class="underwater-bubbles" id="underwaterBubbles" style="display: none;"></div>
        <div class="sky-clouds" id="skyClouds" style="display: none;"></div>
        <div class="beach-waves" id="beachWaves" style="display: none;"></div>
        <div class="rain-drops" id="rainDrops" style="display: none;"></div>
        <div class="city-lights" id="cityLights" style="display: none;"></div>
        <div class="jungle-leaves" id="jungleLeaves" style="display: none;"></div>
        <div class="aurora-lights" id="auroraLights" style="display: none;"></div>
        <div class="snow-flakes" id="snowFlakes" style="display: none;"></div>
        <div class="cyberpunk-grid" id="cyberpunkGrid" style="display: none;"></div>
        <div class="thunderstorm-effects" id="thunderstormEffects" style="display: none;"></div>
        <div class="wedding-petals" id="weddingPetals" style="display: none;"></div>
        <div class="tropical-fish" id="tropicalFish" style="display: none;"></div>
        <div class="galaxy-spiral" id="galaxySpiral" style="display: none;"></div>
        <div class="neon-lines" id="neonLines" style="display: none;"></div>
        <div class="fireflies" id="fireflies" style="display: none;"></div>
    </div>

    <!-- Blinking Stars -->
    <div class="blinking-stars" id="blinkingStars"></div>

    <!-- Slowly Rotating Stars -->
    <div class="rotating-stars" id="rotatingStars"></div>

    <!-- Passing Planets -->
    <div class="passing-planets" id="passingPlanets"></div>

    <!-- Dark Overlay -->
    <div class="dark-overlay"></div>

    <!-- Main Container -->
    <div class="main-container">
        
        <!-- Dark Header - iPhone 15 Pro Max Optimized -->
        <div class="dark-header">
            <div class="dark-logo">JomBro</div>
            <div class="dark-header-icons">
                <div class="round-btn" onclick="navigateAction(this, 'create')"></div>
                <div class="round-btn" onclick="showBackgroundSettings()"></div>
                <div class="round-btn" onclick="navigateAction(this, 'notifications')">
                    
                    <div class="notification-badge">3</div>
                </div>
                <div class="round-btn" onclick="navigateAction(this, 'messages')"></div>
            </div>
        </div>

        <!-- Dark Stories - iPhone 15 Pro Max Optimized -->
        <div class="dark-stories">
            <div class="stories-scroll">
                <div class="story-item">
                    <div class="story-circle" onclick="storyAction(this)">
                        <div class="story-inner"></div>
                    </div>
                    <div class="story-name">Your Story</div>
                </div>
                <div class="story-item">
                    <div class="story-circle" onclick="storyAction(this)">
                        <div class="story-inner">
                            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=80&h=80&fit=crop&crop=face" alt="Ahmad" class="story-image">
                        </div>
                    </div>
                    <div class="story-name">ahmad_rahman</div>
                </div>
                <div class="story-item">
                    <div class="story-circle" onclick="storyAction(this)">
                        <div class="story-inner">
                            <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?w=80&h=80&fit=crop&crop=face" alt="Mei Ling" class="story-image">
                        </div>
                    </div>
                    <div class="story-name">meilingwong</div>
                </div>
                <div class="story-item">
                    <div class="story-circle" onclick="storyAction(this)">
                        <div class="story-inner">
                            <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=80&h=80&fit=crop&crop=face" alt="Sarah" class="story-image">
                        </div>
                    </div>
                    <div class="story-name">sarahchen</div>
                </div>
                <div class="story-item">
                    <div class="story-circle" onclick="storyAction(this)">
                        <div class="story-inner">
                            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=80&h=80&fit=crop&crop=face" alt="David" class="story-image">
                        </div>
                    </div>
                    <div class="story-name">davidkumar</div>
                </div>
            </div>
        </div>

        <!-- Dark Feed with Page Flip - iPhone 15 Pro Max Optimized -->
        <div class="dark-feed">
            <div class="feed-pages" id="feedPages">
                
                <!-- Challenge Page 1 -->
                <div class="challenge-card current" data-page="0">
                    <!-- Side Actions -->
                    <div class="side-actions">
                        <div class="action-btn points-btn">
                            <div class="points-number" id="userPoints">25.4K</div>
                            <div class="points-label">PTS</div>
                        </div>
                        <div class="action-btn" onclick="likeAction(this)"></div>
                        <div class="action-btn" onclick="commentAction(this)"></div>
                        <div class="action-btn" onclick="shareAction(this)"></div>
                        <div class="action-btn" onclick="saveAction(this)"></div>
                    </div>

                    <!-- Challenge Content -->
                    <div class="challenge-content">
                        <div class="challenge-user">
                            <div class="challenge-avatar">
                                <div class="challenge-avatar-inner">
                                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=48&h=48&fit=crop&crop=face" alt="Ahmad">
                                </div>
                            </div>
                            <div class="challenge-username">ahmad_rahman </div>
                        </div>
                        
                        <div class="challenge-text">
                            "Go to Starbucks and ask the barista to write a poem on your cup! "
                        </div>
                        
                        <div class="challenge-hashtags">
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#StarbucksPoetry</span>
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#SocialChallenge</span>
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#JomBro</span>
                        </div>
                        
                        <div class="challenge-reward">+500 Points</div>
                        
                        <div class="challenge-actions">
                            <button class="challenge-btn btn-accept" onclick="acceptChallenge(1, 500, this)">
                                 Accept Challenge
                            </button>
                            <button class="challenge-btn btn-decline" onclick="declineChallenge(1, this)">
                                Pass
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Challenge Page 2 - Business -->
                <div class="challenge-card next" data-page="1">
                    <div class="side-actions">
                        <div class="action-btn" onclick="likeAction(this)"></div>
                        <div class="action-btn" onclick="commentAction(this)"></div>
                        <div class="action-btn" onclick="shareAction(this)"></div>
                        <div class="action-btn" onclick="saveAction(this)"></div>
                    </div>

                    <div class="challenge-content">
                        <div class="challenge-user">
                            <div class="challenge-avatar" style="background: linear-gradient(45deg, rgba(255, 193, 7, 0.8), rgba(255, 107, 53, 0.8));">
                                <div class="challenge-avatar-inner"></div>
                            </div>
                            <div class="challenge-username">Starbucks Malaysia </div>
                        </div>
                        
                        <div class="challenge-text">
                            " BUSINESS PARTNERSHIP: Complete 5 coffee challenges this week and earn REAL rewards!"
                        </div>
                        
                        <div class="challenge-hashtags">
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#StarbucksPartner</span>
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#RealRewards</span>
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#MoneyChallenge</span>
                        </div>
                        
                        <div class="challenge-reward">+2000 Points + RM50 Voucher</div>
                        
                        <div class="challenge-actions">
                            <button class="challenge-btn btn-accept" onclick="acceptBusinessChallenge(2, 2000, this)">
                                 Join Partnership
                            </button>
                            <button class="challenge-btn btn-decline" onclick="declineChallenge(2, this)">
                                Pass
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Challenge Page 3 -->
                <div class="challenge-card next" data-page="2">
                    <div class="side-actions">
                        <div class="action-btn" onclick="likeAction(this)"></div>
                        <div class="action-btn" onclick="commentAction(this)"></div>
                        <div class="action-btn" onclick="shareAction(this)"></div>
                        <div class="action-btn" onclick="saveAction(this)"></div>
                    </div>

                    <div class="challenge-content">
                        <div class="challenge-user">
                            <div class="challenge-avatar">
                                <div class="challenge-avatar-inner">
                                    <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?w=48&h=48&fit=crop&crop=face" alt="Mei Ling">
                                </div>
                            </div>
                            <div class="challenge-username">meilingwong</div>
                        </div>
                        
                        <div class="challenge-text">
                            "Find someone wearing the same color shirt as you and take a selfie together at KLCC! "
                        </div>
                        
                        <div class="challenge-hashtags">
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#KLCC</span>
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#TwinningChallenge</span>
                            <span class="challenge-hashtag" onclick="hashtagAction(this)">#Malaysia</span>
                        </div>
                        
                        <div class="challenge-reward">+800 Points</div>
                        
                        <div class="challenge-actions">
                            <button class="challenge-btn btn-accept" onclick="acceptChallenge(3, 800, this)">
                                 Accept Challenge
                            </button>
                            <button class="challenge-btn btn-decline" onclick="declineChallenge(3, this)">
                                Pass
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dark Bottom Navigation - iPhone 15 Pro Max Optimized -->
        <div class="dark-nav">
            <div class="nav-item active" onclick="navAction(this, 'home')">
                <div class="nav-icon"></div>
                <div>Home</div>
            </div>
            <div class="nav-item" onclick="navAction(this, 'search')">
                <div class="nav-icon"></div>
                <div>Search</div>
            </div>
            <div class="nav-item" onclick="navAction(this, 'create')">
                <div class="nav-icon"></div>
                <div>Create</div>
            </div>
            <div class="nav-item" onclick="navAction(this, 'activity')">
                <div class="nav-icon"></div>
                <div>Activity</div>
            </div>
            <div class="nav-item" onclick="navAction(this, 'profile')">
                <div class="nav-icon"></div>
                <div>Profile</div>
            </div>
        </div>
    </div>

    <!-- Background Settings Modal -->
    <div id="backgroundModal" class="modal">
        <div class="modal-content">
            <div class="modal-title"> Choose Your Atmosphere</div>
            
            <div class="background-grid">
                <div class="bg-option" onclick="changeBackground('space')" data-bg="space">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Outer Space</div>
                </div>
                <div class="bg-option" onclick="changeBackground('underwater')" data-bg="underwater">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Underwater Island</div>
                </div>
                <div class="bg-option" onclick="changeBackground('sky')" data-bg="sky">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Sky Clouds</div>
                </div>
                <div class="bg-option" onclick="changeBackground('beach')" data-bg="beach">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Beach Waves</div>
                </div>
                <div class="bg-option" onclick="changeBackground('rainy')" data-bg="rainy">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Rainy Day</div>
                </div>
                <div class="bg-option" onclick="changeBackground('city')" data-bg="city">
                    <div class="bg-preview"></div>
                    <div class="bg-name">City Drizzle</div>
                </div>
                <div class="bg-option" onclick="changeBackground('jungle')" data-bg="jungle">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Jungle Seaside</div>
                </div>
                <div class="bg-option" onclick="changeBackground('forest')" data-bg="forest">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Forest Woods</div>
                </div>
                <div class="bg-option" onclick="changeBackground('mountain')" data-bg="mountain">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Mountain Peaks</div>
                </div>
                <div class="bg-option" onclick="changeBackground('desert')" data-bg="desert">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Desert Dunes</div>
                </div>
                <div class="bg-option" onclick="changeBackground('aurora')" data-bg="aurora">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Aurora Borealis</div>
                </div>
                <div class="bg-option" onclick="changeBackground('sunset')" data-bg="sunset">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Golden Sunset</div>
                </div>
                <div class="bg-option" onclick="changeBackground('snowy')" data-bg="snowy">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Snowy Winter</div>
                </div>
                <div class="bg-option" onclick="changeBackground('cyberpunk')" data-bg="cyberpunk">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Cyberpunk City</div>
                </div>
                <div class="bg-option" onclick="changeBackground('volcano')" data-bg="volcano">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Volcanic Lava</div>
                </div>
                <div class="bg-option" onclick="changeBackground('thunderstorm')" data-bg="thunderstorm">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Thunderstorm</div>
                </div>
                <div class="bg-option" onclick="changeBackground('wedding')" data-bg="wedding">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Wedding Day</div>
                </div>
                <div class="bg-option" onclick="changeBackground('tropical')" data-bg="tropical">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Tropical Paradise</div>
                </div>
                <div class="bg-option" onclick="changeBackground('galaxy')" data-bg="galaxy">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Galaxy Spiral</div>
                </div>
                <div class="bg-option" onclick="changeBackground('neon')" data-bg="neon">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Neon City</div>
                </div>
                <div class="bg-option" onclick="changeBackground('meadow')" data-bg="meadow">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Meadow Fireflies</div>
                </div>
                <div class="bg-option" onclick="changeBackground('twilight')" data-bg="twilight">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Twilight Magic</div>
                </div>
                <div class="bg-option" onclick="changeBackground('carnival')" data-bg="carnival">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Carnival Lights</div>
                </div>
                <div class="bg-option" onclick="changeBackground('ice')" data-bg="ice">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Ice Kingdom</div>
                </div>
                <div class="bg-option" onclick="changeBackground('steampunk')" data-bg="steampunk">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Steampunk</div>
                </div>
                <div class="bg-option" onclick="changeBackground('retro')" data-bg="retro">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Retro Wave</div>
                </div>
                <div class="bg-option" onclick="changeBackground('noir')" data-bg="noir">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Film Noir</div>
                </div>
                <div class="bg-option" onclick="changeBackground('paradise')" data-bg="paradise">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Paradise Island</div>
                </div>
                <div class="bg-option" onclick="changeBackground('mystic')" data-bg="mystic">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Mystic Realm</div>
                </div>
                <div class="bg-option" onclick="changeBackground('future')" data-bg="future">
                    <div class="bg-preview"></div>
                    <div class="bg-name">Future World</div>
                </div>
            </div>
            
            <button class="btn-secondary" onclick="hideModal('background')">Close</button>
        </div>
    </div>

    <!-- Create Modal -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-title"> Create New Challenge</div>
            
            <div class="form-group">
                <label class="form-label">Target Friend</label>
                <select class="form-control" id="challengeTarget">
                    <option value="">Choose friend...</option>
                    <option value="Ahmad Rahman">ahmad_rahman</option>
                    <option value="Mei Ling Wong">meilingwong</option>
                    <option value="Sarah Chen">sarahchen</option>
                    <option value="David Kumar">davidkumar</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">Challenge Description</label>
                <textarea class="form-control" id="challengeDesc" rows="3" placeholder="Describe your epic challenge..." style="resize: vertical;"></textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">Reward Points</label>
                <select class="form-control" id="challengePoints">
                    <option value="200">200 Points (Easy)</option>
                    <option value="500">500 Points (Medium)</option>
                    <option value="800">800 Points (Hard)</option>
                    <option value="1000">1000 Points (Epic)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">Business Partnership</label>
                <select class="form-control" id="businessPartner">
                    <option value="">No business partner</option>
                    <option value="Starbucks">Starbucks Malaysia</option>
                    <option value="McDonald's">McDonald's Malaysia</option>
                    <option value="Grab">Grab Malaysia</option>
                    <option value="Shopee">Shopee</option>
                </select>
            </div>
            
            <button class="btn-primary" onclick="createChallenge()"> Share Challenge</button>
            <button class="btn-secondary" onclick="hideModal('create')">Cancel</button>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast">
        <span id="toastText">Success!</span>
    </div>

    <script>
        let userPoints = 25430;
        let completedChallenges = [];
        let businessPartnerships = [];
        let currentPage = 0;
        let totalPages = 3;
        let isFlipping = false;
        let currentBackground = 'space';

        // iPhone 15 Pro Max Page Flip System
        function flipToPage(targetPage) {
            if (isFlipping || targetPage < 0 || targetPage >= totalPages) return;
            
            isFlipping = true;
            const cards = document.querySelectorAll('.challenge-card');
            
            cards.forEach((card, index) => {
                card.classList.remove('current', 'next', 'prev');
                
                if (index === targetPage) {
                    card.classList.add('current');
                } else if (index > targetPage) {
                    card.classList.add('next');
                } else {
                    card.classList.add('prev');
                }
            });
            
            currentPage = targetPage;
            
            setTimeout(() => {
                isFlipping = false;
            }, 800);
        }

        // iPhone 15 Pro Max Touch/Swipe handlers
        let startY = 0;
        let endY = 0;
        
        document.querySelector('.dark-feed').addEventListener('touchstart', (e) => {
            startY = e.touches[0].clientY;
        }, { passive: true });
        
        document.querySelector('.dark-feed').addEventListener('touchend', (e) => {
            endY = e.changedTouches[0].clientY;
            const diff = startY - endY;
            const threshold = 60; // Optimized for iPhone 15 Pro Max
            
            if (Math.abs(diff) > threshold) {
                if (diff > 0) {
                    flipToPage(currentPage + 1);
                } else {
                    flipToPage(currentPage - 1);
                }
            }
        }, { passive: true });

        // Initialize app for iPhone 15 Pro Max
        document.addEventListener('DOMContentLoaded', function() {
            createSpaceElements();
            updatePointsDisplay();
            
            // iPhone 15 Pro Max specific initialization
            if (navigator.userAgent.includes('iPhone')) {
                document.body.classList.add('iphone-optimized');
            }
        });

        // Background Management System
        function showBackgroundSettings() {
            showModal('background');
            updateActiveBackground();
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200]);
            }
        }

        function changeBackground(bgType) {
            currentBackground = bgType;
            
            document.body.style.transition = 'all 2.524s ease';
            document.body.className = bgType !== 'space' ? bgType : '';
            
            document.querySelectorAll('#backgroundEffects > div').forEach(el => {
                el.style.display = 'none';
            });
            
            if (bgType !== 'space') {
                document.querySelector('.starfield').style.display = 'none';
                document.getElementById('blinkingStars').style.display = 'none';
                document.getElementById('rotatingStars').style.display = 'none';
                document.getElementById('passingPlanets').style.display = 'none';
            } else {
                document.querySelector('.starfield').style.display = 'block';
                document.getElementById('blinkingStars').style.display = 'block';
                document.getElementById('rotatingStars').style.display = 'block';
                document.getElementById('passingPlanets').style.display = 'block';
            }
            
            switch(bgType) {
                case 'underwater':
                    document.getElementById('underwaterBubbles').style.display = 'block';
                    createBubbles();
                    break;
                case 'sky':
                    document.getElementById('skyClouds').style.display = 'block';
                    createClouds();
                    break;
                case 'beach':
                case 'paradise':
                    document.getElementById('beachWaves').style.display = 'block';
                    break;
                case 'rainy':
                case 'city':
                case 'noir':
                    document.getElementById('rainDrops').style.display = 'block';
                    if (bgType === 'city') {
                        document.getElementById('cityLights').style.display = 'block';
                    }
                    createRainDrops();
                    break;
                case 'jungle':
                case 'forest':
                    document.getElementById('jungleLeaves').style.display = 'block';
                    createLeaves();
                    break;
                case 'aurora':
                case 'mystic':
                    document.getElementById('auroraLights').style.display = 'block';
                    break;
                case 'snowy':
                case 'ice':
                    document.getElementById('snowFlakes').style.display = 'block';
                    createSnowflakes();
                    break;
                case 'cyberpunk':
                case 'future':
                case 'steampunk':
                    document.getElementById('cyberpunkGrid').style.display = 'block';
                    break;
                case 'thunderstorm':
                    document.getElementById('thunderstormEffects').style.display = 'block';
                    createThunderstorm();
                    break;
                case 'wedding':
                    document.getElementById('weddingPetals').style.display = 'block';
                    createWeddingPetals();
                    break;
                case 'tropical':
                    document.getElementById('tropicalFish').style.display = 'block';
                    createTropicalFish();
                    break;
                case 'galaxy':
                    document.getElementById('galaxySpiral').style.display = 'block';
                    break;
                case 'neon':
                case 'retro':
                case 'carnival':
                    document.getElementById('neonLines').style.display = 'block';
                    break;
                case 'meadow':
                case 'twilight':
                    document.getElementById('fireflies').style.display = 'block';
                    createFireflies();
                    break;
            }
            
            updateActiveBackground();
            hideModal('background');
            
            setTimeout(() => {
                showToast(` Atmosphere transformed to ${getBgDisplayName(bgType)}!`);
            }, 2524);
            
            if (navigator.vibrate) {
                navigator.vibrate([180, 90, 180, 90, 180]);
            }
        }

        function updateActiveBackground() {
            document.querySelectorAll('.bg-option').forEach(option => {
                option.classList.remove('active');
                if (option.dataset.bg === currentBackground) {
                    option.classList.add('active');
                }
            });
        }

        function getBgDisplayName(bgType) {
            const names = {
                space: 'Outer Space',
                underwater: 'Underwater Island',
                sky: 'Sky Clouds',
                beach: 'Beach Waves',
                rainy: 'Rainy Day',
                city: 'City Drizzle',
                jungle: 'Jungle Seaside',
                forest: 'Forest Woods',
                mountain: 'Mountain Peaks',
                desert: 'Desert Dunes',
                aurora: 'Aurora Borealis',
                sunset: 'Golden Sunset',
                snowy: 'Snowy Winter',
                cyberpunk: 'Cyberpunk City',
                volcano: 'Volcanic Lava',
                thunderstorm: 'Thunderstorm',
                wedding: 'Wedding Day',
                tropical: 'Tropical Paradise',
                galaxy: 'Galaxy Spiral',
                neon: 'Neon City',
                meadow: 'Meadow Fireflies',
                twilight: 'Twilight Magic',
                carnival: 'Carnival Lights',
                ice: 'Ice Kingdom',
                steampunk: 'Steampunk',
                retro: 'Retro Wave',
                noir: 'Film Noir',
                paradise: 'Paradise Island',
                mystic: 'Mystic Realm',
                future: 'Future World'
            };
            return names[bgType] || bgType;
        }

        // Dynamic Background Effect Creators
        function createBubbles() {
            const container = document.getElementById('underwaterBubbles');
            container.innerHTML = '';
            
            function addBubble() {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                bubble.style.left = Math.random() * 100 + '%';
                bubble.style.width = (Math.random() * 30 + 10) + 'px';
                bubble.style.height = bubble.style.width;
                bubble.style.animationDelay = Math.random() * 8 + 's';
                bubble.style.animationDuration = (Math.random() * 5 + 8) + 's';
                
                container.appendChild(bubble);
                
                setTimeout(() => {
                    if (container.contains(bubble)) {
                        container.removeChild(bubble);
                    }
                }, 13000);
            }
            
            for (let i = 0; i < 15; i++) {
                setTimeout(addBubble, i * 300);
            }
            
            setInterval(() => {
                if (currentBackground === 'underwater') {
                    addBubble();
                }
            }, 1000);
        }

        function createSnowflakes() {
            const container = document.getElementById('snowFlakes');
            container.innerHTML = '';
            const snowflakes = ['', '', ''];
            
            function addSnowflake() {
                const flake = document.createElement('div');
                flake.className = 'snowflake';
                flake.textContent = snowflakes[Math.floor(Math.random() * snowflakes.length)];
                flake.style.left = Math.random() * 100 + '%';
                flake.style.animationDelay = Math.random() * 10 + 's';
                flake.style.animationDuration = (Math.random() * 5 + 10) + 's';
                flake.style.fontSize = (Math.random() * 0.8 + 0.8) + 'em';
                
                container.appendChild(flake);
                
                setTimeout(() => {
                    if (container.contains(flake)) {
                        container.removeChild(flake);
                    }
                }, 15000);
            }
            
            for (let i = 0; i < 20; i++) {
                setTimeout(addSnowflake, i * 500);
            }
            
            setInterval(() => {
                if (currentBackground === 'snowy' || currentBackground === 'ice') {
                    addSnowflake();
                }
            }, 1000);
        }

        function createClouds() {
            const container = document.getElementById('skyClouds');
            container.innerHTML = '';
            
            function addCloud() {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                cloud.style.top = Math.random() * 60 + '%';
                cloud.style.left = '-150px';
                cloud.style.width = (Math.random() * 80 + 60) + 'px';
                cloud.style.height = (Math.random() * 30 + 20) + 'px';
                cloud.style.animationDuration = (Math.random() * 20 + 30) + 's';
                
                container.appendChild(cloud);
                
                setTimeout(() => {
                    if (container.contains(cloud)) {
                        container.removeChild(cloud);
                    }
                }, 50000);
            }
            
            for (let i = 0; i < 5; i++) {
                setTimeout(addCloud, i * 3000);
            }
            
            setInterval(() => {
                if (currentBackground === 'sky') {
                    addCloud();
                }
            }, 8000);
        }

        function createRainDrops() {
            const container = document.getElementById('rainDrops');
            container.innerHTML = '';
            
            function addRainDrop() {
                const drop = document.createElement('div');
                drop.className = 'rain-drop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDelay = Math.random() * 1 + 's';
                drop.style.animationDuration = (Math.random() * 0.5 + 1.5) + 's';
                
                container.appendChild(drop);
                
                setTimeout(() => {
                    if (container.contains(drop)) {
                        container.removeChild(drop);
                    }
                }, 2000);
            }
            
            setInterval(() => {
                if (currentBackground === 'rainy' || currentBackground === 'city' || currentBackground === 'noir') {
                    for (let i = 0; i < 5; i++) {
                        setTimeout(addRainDrop, i * 50);
                    }
                }
            }, 200);
        }

        function createLeaves() {
            const container = document.getElementById('jungleLeaves');
            container.innerHTML = '';
            
            function addLeaf() {
                const leaf = document.createElement('div');
                leaf.className = 'leaf';
                leaf.style.left = Math.random() * 100 + '%';
                leaf.style.animationDelay = Math.random() * 12 + 's';
                leaf.style.animationDuration = (Math.random() * 8 + 12) + 's';
                leaf.style.backgroundColor = `hsl(${Math.random() * 60 + 90}, 70%, ${Math.random() * 30 + 30}%)`;
                
                container.appendChild(leaf);
                
                setTimeout(() => {
                    if (container.contains(leaf)) {
                        container.removeChild(leaf);
                    }
                }, 20000);
            }
            
            for (let i = 0; i < 8; i++) {
                setTimeout(addLeaf, i * 1000);
            }
            
            setInterval(() => {
                if (currentBackground === 'jungle' || currentBackground === 'forest') {
                    addLeaf();
                }
            }, 3000);
        }

        function createThunderstorm() {
            const container = document.getElementById('thunderstormEffects');
            container.innerHTML = '';
            
            function addLightning() {
                const lightning = document.createElement('div');
                lightning.className = 'lightning';
                lightning.style.left = Math.random() * 100 + '%';
                lightning.style.animationDelay = Math.random() * 2 + 's';
                
                container.appendChild(lightning);
                
                setTimeout(() => {
                    if (container.contains(lightning)) {
                        container.removeChild(lightning);
                    }
                }, 500);
            }
            
            setInterval(() => {
                if (currentBackground === 'thunderstorm') {
                    if (Math.random() > 0.7) {
                        addLightning();
                    }
                }
            }, 2000);
        }

        function createWeddingPetals() {
            const container = document.getElementById('weddingPetals');
            container.innerHTML = '';
            
            function addPetal() {
                const petal = document.createElement('div');
                petal.className = 'petal';
                petal.style.left = Math.random() * 100 + '%';
                petal.style.animationDelay = Math.random() * 8 + 's';
                petal.style.animationDuration = (Math.random() * 4 + 8) + 's';
                
                container.appendChild(petal);
                
                setTimeout(() => {
                    if (container.contains(petal)) {
                        container.removeChild(petal);
                    }
                }, 12000);
            }
            
            for (let i = 0; i < 20; i++) {
                setTimeout(addPetal, i * 400);
            }
            
            setInterval(() => {
                if (currentBackground === 'wedding') {
                    addPetal();
                }
            }, 1500);
        }

        function createTropicalFish() {
            const container = document.getElementById('tropicalFish');
            container.innerHTML = '';
            
            function addFish() {
                const fish = document.createElement('div');
                fish.className = 'fish';
                fish.style.top = Math.random() * 80 + 10 + '%';
                fish.style.left = '-50px';
                fish.style.animationDuration = (Math.random() * 10 + 15) + 's';
                fish.style.animationDelay = Math.random() * 5 + 's';
                
                const colors = ['rgba(255,165,0,0.7)', 'rgba(255,69,0,0.7)', 'rgba(30,144,255,0.7)', 'rgba(255,20,147,0.7)'];
                fish.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                container.appendChild(fish);
                
                setTimeout(() => {
                    if (container.contains(fish)) {
                        container.removeChild(fish);
                    }
                }, 25000);
            }
            
            for (let i = 0; i < 5; i++) {
                setTimeout(addFish, i * 3000);
            }
            
            setInterval(() => {
                if (currentBackground === 'tropical' || currentBackground === 'paradise') {
                    addFish();
                }
            }, 8000);
        }

        function createFireflies() {
            const container = document.getElementById('fireflies');
            container.innerHTML = '';
            
            function addFirefly() {
                const firefly = document.createElement('div');
                firefly.className = 'firefly';
                firefly.style.left = Math.random() * 100 + '%';
                firefly.style.top = Math.random() * 100 + '%';
                firefly.style.animationDelay = Math.random() * 8 + 's';
                firefly.style.animationDuration = (Math.random() * 4 + 8) + 's';
                
                container.appendChild(firefly);
                
                setTimeout(() => {
                    if (container.contains(firefly)) {
                        container.removeChild(firefly);
                    }
                }, 12000);
            }
            
            for (let i = 0; i < 15; i++) {
                setTimeout(addFirefly, i * 500);
            }
            
            setInterval(() => {
                if (currentBackground === 'meadow' || currentBackground === 'twilight') {
                    addFirefly();
                }
            }, 2000);
        }

        // Create Outer Space Elements
        function createSpaceElements() {
            createBlinkingStars();
            createRotatingStars();
            createPassingPlanets();
        }

        function createBlinkingStars() {
            const container = document.getElementById('blinkingStars');
            const colors = ['', 'blue', 'yellow', 'pink'];
            
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = `blinking-star ${colors[Math.floor(Math.random() * colors.length)]}`;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 8 + 's';
                container.appendChild(star);
            }
        }

        function createRotatingStars() {
            const container = document.getElementById('rotatingStars');
            
            for (let i = 0; i < 30; i++) {
                const star = document.createElement('div');
                star.className = 'rotating-star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 8 + 's';
                container.appendChild(star);
            }
        }

        function createPassingPlanets() {
            const container = document.getElementById('passingPlanets');
            
            // Mars
            const mars = document.createElement('div');
            mars.className = 'planet mars';
            mars.style.left = '-50px';
            mars.style.top = '20%';
            container.appendChild(mars);
            
            // Jupiter
            const jupiter = document.createElement('div');
            jupiter.className = 'planet jupiter';
            jupiter.style.left = '-80px';
            jupiter.style.top = '60%';
            container.appendChild(jupiter);
            
            // Saturn
            const saturn = document.createElement('div');
            saturn.className = 'planet saturn';
            saturn.style.left = '-60px';
            saturn.style.top = '40%';
            container.appendChild(saturn);
        }

        // Points and Data Management
        function updatePointsDisplay() {
            const pointsElement = document.getElementById('userPoints');
            if (pointsElement) {
                if (userPoints >= 1000) {
                    pointsElement.textContent = (userPoints / 1000).toFixed(1) + 'K';
                } else {
                    pointsElement.textContent = userPoints.toString();
                }
            }
        }

        function addPoints(points) {
            userPoints += points;
            updatePointsDisplay();
            createFloatingPoints(points);
        }

        function createFloatingPoints(points) {
            const pointsBtn = document.querySelector('.points-btn');
            if (pointsBtn) {
                const floatingText = document.createElement('div');
                floatingText.textContent = `+${points}`;
                floatingText.style.cssText = `
                    position: absolute;
                    top: -20px;
                    left: 50%;
                    transform: translateX(-50%);
                    color: #00FF96;
                    font-weight: bold;
                    font-size: 16px;
                    pointer-events: none;
                    z-index: 1000;
                    text-shadow: 0 0 10px rgba(0, 255, 150, 0.6);
                    animation: moneyFloat 2s ease-out forwards;
                `;
                pointsBtn.appendChild(floatingText);
                
                setTimeout(() => {
                    if (pointsBtn.contains(floatingText)) {
                        pointsBtn.removeChild(floatingText);
                    }
                }, 2000);
            }
        }

        // Challenge Actions
        function acceptChallenge(challengeId, points, button) {
            if (completedChallenges.includes(challengeId)) {
                showToast(' Challenge already completed!');
                return;
            }
            
            completedChallenges.push(challengeId);
            addPoints(points);
            
            button.innerHTML = ' Challenge Accepted!';
            button.disabled = true;
            button.style.opacity = '0.7';
            
            showToast(` Challenge accepted! +${points} points earned!`);
            
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100, 50, 200]);
            }
            
            setTimeout(() => {
                flipToPage(currentPage + 1);
            }, 2000);
        }

        function acceptBusinessChallenge(challengeId, points, button) {
            if (businessPartnerships.includes(challengeId)) {
                showToast(' Partnership already active!');
                return;
            }
            
            businessPartnerships.push(challengeId);
            addPoints(points);
            
            button.innerHTML = ' Partnership Joined!';
            button.disabled = true;
            button.style.opacity = '0.7';
            
            // Create business floating animation
            const businessIcon = document.createElement('div');
            businessIcon.textContent = '';
            businessIcon.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                font-size: 48px;
                pointer-events: none;
                z-index: 2000;
                animation: businessFloat 2.5s ease-out forwards;
            `;
            document.body.appendChild(businessIcon);
            
            setTimeout(() => {
                if (document.body.contains(businessIcon)) {
                    document.body.removeChild(businessIcon);
                }
            }, 2500);
            
            showToast(` Business Partnership joined! +${points} points + Real Rewards!`);
            
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200, 100, 300]);
            }
            
            setTimeout(() => {
                flipToPage(currentPage + 1);
            }, 2500);
        }

        function declineChallenge(challengeId, button) {
            button.innerHTML = 'Passed';
            button.disabled = true;
            button.style.opacity = '0.5';
            
            showToast(' Challenge passed. Next one coming up!');
            
            setTimeout(() => {
                flipToPage(currentPage + 1);
            }, 1500);
        }

        // Social Actions
        function likeAction(button) {
            const currentIcon = button.textContent;
            const isLiked = currentIcon === '';
            
            button.textContent = isLiked ? '' : '';
            
            if (!isLiked) {
                const heart = document.createElement('div');
                heart.textContent = '';
                heart.style.cssText = `
                    position: absolute;
                    top: -10px;
                    left: 50%;
                    transform: translateX(-50%);
                    font-size: 20px;
                    pointer-events: none;
                    z-index: 1000;
                    animation: heartFloat 1.5s ease-out forwards;
                `;
                button.appendChild(heart);
                
                setTimeout(() => {
                    if (button.contains(heart)) {
                        button.removeChild(heart);
                    }
                }, 1500);
                
                showToast(' Liked!');
            } else {
                showToast(' Unliked');
            }
            
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function commentAction(button) {
            showToast(' Comments feature coming soon!');
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function shareAction(button) {
            if (navigator.share) {
                navigator.share({
                    title: 'JomBro Challenge',
                    text: 'Check out this awesome challenge on JomBro!',
                    url: window.location.href
                });
            } else {
                showToast(' Challenge shared!');
            }
            
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100]);
            }
        }

        function saveAction(button) {
            const currentIcon = button.textContent;
            const isSaved = currentIcon === '';
            
            button.textContent = isSaved ? '' : '';
            showToast(isSaved ? ' Unsaved' : ' Saved!');
            
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        // Story Actions
        function storyAction(element) {
            showToast(' Stories feature coming soon!');
            if (navigator.vibrate) {
                navigator.vibrate([80, 40, 80]);
            }
        }

        // Hashtag Actions
        function hashtagAction(element) {
            const hashtag = element.textContent;
            showToast(` Searching for ${hashtag}...`);
            if (navigator.vibrate) {
                navigator.vibrate(30);
            }
        }

        // Navigation Actions
        function navigateAction(button, action) {
            if (action === 'create') {
                showModal('create');
            } else if (action === 'notifications') {
                showToast(' Notifications feature coming soon!');
            } else if (action === 'messages') {
                showToast(' Messages feature coming soon!');
            }
            
            if (navigator.vibrate) {
                navigator.vibrate([60, 30, 60]);
            }
        }

        function navAction(element, section) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            element.classList.add('active');
            
            switch(section) {
                case 'home':
                    showToast(' Home');
                    break;
                case 'search':
                    showToast(' Search feature coming soon!');
                    break;
                case 'create':
                    showModal('create');
                    break;
                case 'activity':
                    showToast(' Activity feature coming soon!');
                    break;
                case 'profile':
                    showToast(' Profile feature coming soon!');
                    break;
            }
            
            if (navigator.vibrate) {
                navigator.vibrate(40);
            }
        }

        // Modal Management
        function showModal(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                
                if (navigator.vibrate) {
                    navigator.vibrate([80, 40, 80]);
                }
            }
        }

        function hideModal(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if (modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'hidden';
                
                if (modalType === 'create') {
                    clearCreateForm();
                }
            }
        }

        // Click outside modal to close
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                const modalType = e.target.id.replace('Modal', '');
                hideModal(modalType);
            }
        });

        // Create Challenge Functions
        function createChallenge() {
            const target = document.getElementById('challengeTarget').value;
            const description = document.getElementById('challengeDesc').value;
            const points = document.getElementById('challengePoints').value;
            const partner = document.getElementById('businessPartner').value;
            
            if (!target || !description) {
                showToast(' Please fill in all required fields');
                return;
            }
            
            hideModal('create');
            showToast(' Challenge shared successfully!');
            addPoints(100);
            
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200]);
            }
        }

        function clearCreateForm() {
            document.getElementById('challengeTarget').value = '';
            document.getElementById('challengeDesc').value = '';
            document.getElementById('challengePoints').value = '200';
            document.getElementById('businessPartner').value = '';
        }

        // Toast Notifications
        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastText = document.getElementById('toastText');
            
            toastText.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Error Handling and Performance
        window.addEventListener('error', (e) => {
            console.error('JomBro Error:', e.error);
            showToast(' Something went wrong. Please try again.');
        });

        // Prevent context menu on mobile
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
        });

        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // iPhone 15 Pro Max specific optimizations
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                console.log('JomBro: Ready for PWA implementation');
            });
        }

        // Performance monitoring
        if ('PerformanceObserver' in window) {
            const observer = new PerformanceObserver((list) => {
                list.getEntries().forEach((entry) => {
                    if (entry.entryType === 'measure') {
                        console.log(`JomBro Performance: ${entry.name} took ${entry.duration}ms`);
                    }
                });
            });
            observer.observe({ entryTypes: ['measure'] });
        }

        // Battery optimization
        if ('getBattery' in navigator) {
            navigator.getBattery().then((battery) => {
                if (battery.level < 0.2) {
                    document.body.classList.add('low-power-mode');
                }
            });
        }

        // iPhone 15 Pro Max viewport adjustments
        function adjustForSafeArea() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            
            // Dynamic Island detection
            if (screen.height === 932 && screen.width === 430) {
                document.documentElement.style.setProperty('--safe-area-top', '47px');
                document.documentElement.style.setProperty('--safe-area-bottom', '34px');
            }
        }

        window.addEventListener('resize', adjustForSafeArea);
        window.addEventListener('orientationchange', adjustForSafeArea);
        adjustForSafeArea();

        // iPhone 15 Pro Max specific touch optimizations
        document.addEventListener('touchstart', function(e) {
            // Prevent 300ms click delay
            e.preventDefault();
            
            // Handle touch for better responsiveness
            const touch = e.touches[0];
            const element = document.elementFromPoint(touch.clientX, touch.clientY);
            
            if (element && element.onclick) {
                element.click();
            }
        }, { passive: false });

        // Optimize for iPhone 15 Pro Max display
        if (window.devicePixelRatio >= 3) {
            document.body.classList.add('high-density-display');
        }

        // Final initialization
        console.log(' JomBro: iPhone 15 Pro Max Optimized - Social Challenge App Initialized!');
        console.log(' Screen: 430932px | Dynamic Island Support | 120Hz ProMotion Ready');
        console.log(' Features: 30+ Backgrounds, Social Challenges, Real Business Partnerships');
        console.log(' Optimized with smooth 1.8s floating animations for premium mobile experience');
    </script>
</body>
</html>
